<scriptedContentFragments><scriptedContentFragment name="${resource:activityStoryStream_name}" version="7.0.0.1" description="${resource:activityStoryStream_description}" instanceIdentifier="ff79be4dcc9b4884bbf9a455ef5eb1c5" theme="" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="activity-story-stream"><contentScript>#set ($pageSize = $core_v2_widget.GetIntValue('pageSize', 15))
#set ($endlessScroll = $core_v2_widget.GetBoolValue('endlessScroll', true))

#set($filterType = false)
#set($filterType = $core_v2_widget.GetStringValue('filterType', ''))

#set ($user = false)
#if ($filterType == 'User')
	#set($user = $core_v2_user.Current)
	#if (!$user)
		#set ($user = $core_v2_user.Accessing)
	#end
	## if contextual/accessing user is anonymous, fall back to site filter mode
	#if (!$core_v2_user.IsRegistered($user.Id))
		#set ($filterType = 'Site')
	#end
#else
	#set($user = $core_v2_user.Accessing)
#end

#set ($group = $core_v2_group.Current)

#set ($messageId = '')
#set ($messageId = $core_v2_page.GetQueryStringValue('ActivityMessageID'))

#set ($loadingId = $core_v2_widget.UniqueId('loading'))
#set ($pagerId = $core_v2_widget.UniqueId('pager'))
#set ($containerId = $core_v2_widget.UniqueId('containerId'))
#set ($tabsId = $core_v2_widget.UniqueId('tabs'))

&lt;div class="content-list-header activity-stories"&gt;&lt;/div&gt;
&lt;div class="content-list-name activity-stories"&gt;&lt;/div&gt;
&lt;ul class="content-list activity-stories" id="$containerId"&gt;&lt;/ul&gt;
&lt;div class="content-list-footer activity-stories"&gt;&lt;/div&gt;

#if (!$endlessScroll &amp;&amp; $messageId.length == 0)
	&lt;div class="pager" id="$pagerId"&gt;
		&lt;a href="#"&gt;$core_v2_language.GetResource('showMore')&lt;/a&gt;
	&lt;/div&gt;
#end

&lt;div id="$loadingId" class="message loading"&gt;$core_v2_language.GetResource('loading')&lt;/div&gt;

#registerEndOfPageHtml('telligent.evolution.widgets.activityStoryStream')
	&lt;script type="text/javascript" src="$core_v2_encoding.HtmlAttributeEncode($core_v2_widget.GetFileUrl("ui.js"))"&gt;&lt;/script&gt;
#end
#registerEndOfPageHtml()
	&lt;script type="text/javascript"&gt;
		jQuery(function(){
			jQuery.telligent.evolution.widgets.activityStoryStream.register({
				wrapper: '#$core_v2_widget.WrapperElementId',
				loader: '#$core_v2_encoding.JavascriptEncode($loadingId)',
				pager: '#$core_v2_encoding.JavascriptEncode($pagerId)',
				container: '#$core_v2_encoding.JavascriptEncode($containerId)',
				filterType: '$core_v2_encoding.JavascriptEncode($filterType)',
				tabs: '#$core_v2_encoding.JavascriptEncode($tabsId)',
				pageSize: $pageSize,
				streamUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('stream.vm'))',
				messageId: '$core_v2_encoding.JavascriptEncode($messageId)',
				moreCommentsUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('morecomments.vm'))',
				accessingUserId: $core_v2_user.Accessing.Id,
				userId: #if($user)$user.Id#else-1#end,
				groupId: #if($goupr)$group.Id#else-1#end,
				maxReplyLength: $core_v2_configuration.ActivityMessageReplyMaxLength,
				todayText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('today'))',
				endlessScroll: #if($endlessScroll &amp;&amp; $messageId.length == 0) true #else false #end,
				hideOriginalPost: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('hideOriginalPost'))',
				showOriginalPost: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('showOriginalPost'))',
				hideHistory: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('hideHistory'))',
				showHistory: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('showHistory'))',
				deleteActivityMessage: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('deleteActivityMessage'))',
				deleteCommentMessage: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('deleteCommentMessage'))',
				commentModeratedMessaage: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('CF_Comment_ModeratedMessaage'))'
			});
		});
	&lt;/script&gt;
#end</contentScript><headerScript>$core_v2_widget.ApplyTokens($core_v2_widget.GetStringValue('fragmentHeader', '${resource:activityStoryStream_name}'))</headerScript><configuration>&lt;propertyGroup id="options" resourceName="options"&gt;
	&lt;property id="fragmentHeader" resourceName="title" dataType="string" defaultValue="${resource:activityStoryStream_name}" controlType="Telligent.Evolution.Controls.ContentFragmentTokenStringControl, Telligent.Evolution.Extensions.SitecoreConnect" /&gt;
	&lt;property id="pageSize" resourceName="pageSize" dataType="int" defaultValue="15"&gt;
		&lt;propertyRule type="Telligent.Evolution.Controls.PropertyRules.MinMaxValueRule, Telligent.Evolution.Extensions.SitecoreConnect" minValue="1" maxValue="100" /&gt;
	&lt;/property&gt;
	&lt;property id="filterType" resourceName="filterType" descriptionResourceName="filterType_Desc" dataType="string" defaultValue="" controlType="Telligent.Evolution.Controls.PropertyVisibilityValueSelectionControl, Telligent.Evolution.Extensions.SitecoreConnect"&gt;
		&lt;propertyValue value="Site" resourceName="filterType_site"
			propertiesToHide="includeSubGroups,filterUserActivityTypes0,filterUserActivityTypes1,filterUserActivityTypes2,filterUserActivityTypes3,filterUserActivityTypes4"
			propertiesToShow="activityTypes0,filterActivityTypes1,filterActivityTypes2,filterActivityTypes3,filterActivityTypes4" /&gt;
		&lt;propertyValue value="Group" resourceName="filterType_group"
			propertiesToHide="filterUserActivityTypes0,filterUserActivityTypes1,filterUserActivityTypes2,filterUserActivityTypes3,filterUserActivityTypes4"
			propertiesToShow="includeSubGroups,filterActivityTypes0,filterActivityTypes1,filterActivityTypes2,filterActivityTypes3,filterActivityTypes4" /&gt;
		&lt;propertyValue value="User" resourceName="filterType_userProfile"
			propertiesToHide="includeSubGroups,filterActivityTypes0,filterActivityTypes1,filterActivityTypes2,filterActivityTypes3,activityTypes4"
			propertiesToShow="filterUserActivityTypes0,filterUserActivityTypes1,filterUserActivityTypes2,filterUserActivityTypes3,filterUserActivityTypes4" /&gt;
	&lt;/property&gt;
	&lt;property id="includeSubGroups" resourceName="includeSubGroups" dataType="bool" defaultValue="false" /&gt;
	&lt;property id="endlessScroll" resourceName="endlessScroll" descriptionResourceName="endlessScrollDesc" dataType="bool" defaultValue="true" /&gt;
&lt;/propertyGroup&gt;</configuration><languageResources><language key="en-us"><resource name="CF_Comment_ModeratedMessaage">Thank you, your comment requires moderation so it may take a while to appear.</resource><resource name="activityStoryStream_name">Activity Story Stream</resource><resource name="activityStoryStream_description">Displays a stream of activity stories from the site with previews.</resource><resource name="options">Options</resource><resource name="title">Widget Title</resource><resource name="pageSize">Number of Items to Display</resource><resource name="filterType">Activity Stream Mode</resource><resource name="filterType_site">Site (all site activity)</resource><resource name="filterType_group">Group (activity in a group and optionally subgroups)</resource><resource name="filterType_userProfile">User (activity for contextual user)</resource><resource name="filterType_Desc">Determines the default view of the Activity Stream and the set of filters to display</resource><resource name="includeSubGroups">Include subgroup activity</resource><resource name="endlessScroll">Endless Stream</resource><resource name="endlessScrollDesc">Automatically load more stories when scrolled near the end</resource><resource name="loading">Loading...</resource><resource name="showMore">Show More</resource><resource name="hideOriginalPost">Hide original post</resource><resource name="showOriginalPost">Show original post</resource><resource name="hideHistory">Hide revision history</resource><resource name="showHistory">Show revision history</resource><resource name="deleteActivityMessage">Are you sure you want to delete this story?</resource><resource name="deleteCommentMessage">Are you sure you want to delete this comment?</resource><resource name="delete">Delete</resource><resource name="message">Send a Private Message</resource><resource name="comment">Comment</resource><resource name="writeComment">Write a comment...</resource><resource name="filterName">Filter Name</resource><resource name="filterDesc">Determines the display name of the filter</resource><resource name="filterNameDefault">Filter</resource><resource name="filter0">Filter 1</resource><resource name="filter1">Filter 2</resource><resource name="filter2">Filter 3</resource><resource name="filter3">Filter 4</resource><resource name="filter4">Filter 5</resource><resource name="filter_desc">Configures an optional filter</resource><resource name="activityTypes">Activity Story Types</resource><resource name="activityTypesDesc">Determines which activities from which users are included in this filter. If no types are selected, the filter will not be displayed.</resource><resource name="activityTypeUsers_Exclude">Exclude activity</resource><resource name="activityTypeUsers_Include">Include contextual user's activity</resource><resource name="activityTypeUsers_User">Include accessing user's activity</resource><resource name="activityTypeUsers_Followed">Include accessing user's followed users' activity</resource><resource name="activityTypeUsers_UserAndFollowed">Include accessing user's and followed users' activity</resource><resource name="activityTypeUsers_All">Include all users' activity</resource><resource name="today">Today</resource><resource name="View">View</resource><resource name="no_messages">There was no activity to display.</resource><resource name="view_more_comments">View more comments</resource></language></languageResources><files><file name="comments.vm">IyMNCiMjIFF1ZXJpZXMgYW5kIHJlbmRlcnMgYSBwYWdlIG9mIGNvbW1lbnRzIGZvciBhbiBhY3Rpdml0eSBzdG9yeQ0KIyMgUmVxdWlyZXMgaW4gc2NvcGU6DQojIyAgICRzdG9yeUlkIG9yICRzdG9yeSBpbnN0YW5jZQ0KIyMgICAkY29tbWVudFBhZ2VJbmRleCAoUmV2ZXJzZWQgMC1iYXNlZC4gMCByZXByZXNlbnRzIGxhc3QgcGFnZSkNCiMjDQoNCiNzZXQgKCRwYWdlU2l6ZSA9IDIwKQ0KDQojaWYgKCEkc3RvcnkpDQoJI3NldCAoJHN0b3J5ID0gJGNvcmVfdjJfYWN0aXZpdHlTdG9yeS5HZXQoJHN0b3J5SWQpKQ0KI2VuZA0KDQojc2V0ICgkYWNjZXNzaW5nVXNlciA9ICRjb3JlX3YyX3VzZXIuQWNjZXNzaW5nKQ0KI3NldCAoJGFjY2Vzc2luZ1VzZXJJc1JlZ2lzdGVyZWQgPSBmYWxzZSkNCiNpZiAoJGNvcmVfdjJfdXNlci5Jc1JlZ2lzdGVyZWQoJGFjY2Vzc2luZ1VzZXIuSWQpKQ0KCSNzZXQgKCRhY2Nlc3NpbmdVc2VySXNSZWdpc3RlcmVkID0gdHJ1ZSkNCiNlbmQNCg0KI3NldCAoJGNvbW1lbnRzU3VwcG9ydGVkID0gZmFsc2UpDQojc2V0ICgkY29tbWVudHNTdXBwb3J0ZWQgPSAkY29yZV92Ml9jb21tZW50cy5TdXBwb3J0c0NvbW1lbnRzKCRzdG9yeS5Db250ZW50VHlwZUlkKSkNCg0KI3NldCAoJGFjY2Vzc2luZ1VzZXJDYW5Db21tZW50ID0gZmFsc2UpDQojaWYgKCRjb21tZW50c1N1cHBvcnRlZCkNCgkjc2V0ICgkYWNjZXNzaW5nVXNlckNhbkNvbW1lbnQgPSAkY29yZV92Ml9jb21tZW50cy5DYW5DcmVhdGVDb21tZW50KCRzdG9yeS5Db250ZW50SWQsICRzdG9yeS5Db250ZW50VHlwZUlkKSkNCiNlbmQNCg0KI3NldCAoJHJldmVyc2VkQ29tbWVudHMgPSBmYWxzZSkNCiNzZXQgKCRjb21tZW50T3B0aW9ucyA9ICIleyBDb250ZW50SWQgPSAkc3RvcnkuQ29udGVudElkLCBDb250ZW50VHlwZSA9ICRzdG9yeS5Db250ZW50VHlwZUlkLCBJc0FwcHJvdmVkID0gJ3RydWUnLCBTb3J0QnkgPSAnQ3JlYXRlZFV0Y0RhdGUnLCBTb3J0T3JkZXIgPSAnRGVzY2VuZGluZycsIFBhZ2VTaXplID0gJHBhZ2VTaXplLCBQYWdlSW5kZXggPSAkY29tbWVudFBhZ2VJbmRleCB9IikNCiNpZiAoJHN0b3J5LlR5cGVJZCkNCgkkY29tbWVudE9wdGlvbnMuQWRkKCdDb21tZW50VHlwZScsICRzdG9yeS5UeXBlSWQpDQojZW5kDQoNCiNzZXQgKCRyZXZlcnNlZENvbW1lbnRzID0gJGNvcmVfdjJfY29tbWVudHMuTGlzdCgkY29tbWVudE9wdGlvbnMpKQ0KDQojaWYgKCRyZXZlcnNlZENvbW1lbnRzKQ0KCSMjIHJldmVyc2UgdGhlIGxhc3QgcGFnZSBpbnRvIHByb3BlciBvcmRlciwgYnV0IFBhZ2VkTGlzdCBkb2Vzbid0IHN1cHBvcnQgdGhpcyBuYXRpdmVseSwgc28gZmlyc3QgY29weSBpbnRvIGFuIGFycmF5DQoJI3NldCAoJGNvbW1lbnRzID0gW10pDQoJI2ZvcmVhY2ggKCRjb21tZW50IGluICRyZXZlcnNlZENvbW1lbnRzKQ0KCQkjc2V0ICgkcmVzcCA9ICRjb21tZW50cy5BZGQoJGNvbW1lbnQpKQ0KCSNlbmQNCgkjc2V0ICgkcmVzcCA9ICRjb21tZW50cy5SZXZlcnNlKCkpDQoNCgkjIyByZW5kZXIgY29tbWVudHMNCgkjc2V0ICgkY29sbGFwc2UgPSBmYWxzZSkNCgkjaWYgKCEkc2luZ2xlU3RvcnkgJiYgJGNvbW1lbnRzLkNvdW50ID4gJGNvbGxhcHNlV2hlbk92ZXIpDQoJCSNzZXQgKCRjb2xsYXBzZSA9IHRydWUpDQoJI2VuZA0KDQoJI3NldCAoJGNvbGxhcHNlQ291bnQgPSAwKQ0KDQoJI3NldCAoJGhhc01vcmVQYWdlcyA9IGZhbHNlKQ0KCSNzZXQgKCRuZXh0UGFnZUluZGV4ID0gJGNvbW1lbnRQYWdlSW5kZXggKyAxKQ0KCSNpZiAoJHJldmVyc2VkQ29tbWVudHMuVG90YWxDb3VudCA+ICRjb21tZW50cy5Db3VudCkNCgkJI3NldCAoJHRvdGFsUGFnZXMgPSAkcmV2ZXJzZWRDb21tZW50cy5Ub3RhbENvdW50IC8gJHJldmVyc2VkQ29tbWVudHMuUGFnZVNpemUpDQoJCSNzZXQgKCR0b3RhbFBhZ2VzID0gJHRvdGFsUGFnZXMgLSAxKQ0KCQkjaWYgKCR0b3RhbFBhZ2VzID49ICRyZXZlcnNlZENvbW1lbnRzLlBhZ2VJbmRleCkNCgkJCSNzZXQgKCRoYXNNb3JlUGFnZXMgPSB0cnVlKQ0KCQkjZW5kDQoJI2VuZA0KCSNpZiAoJGhhc01vcmVQYWdlcykNCgkJPGxpIGNsYXNzPSJjb250ZW50LWl0ZW0gYWN0aW9uIGNvbGxhcHNlIiAjaWYgKCRzaW5nbGVTdG9yeSkgc3R5bGU9ImRpc3BsYXk6YmxvY2siICNlbmQ+DQoJCQk8YSBocmVmPSIjIiBkYXRhLXBhZ2VpbmRleD0iJG5leHRQYWdlSW5kZXgiIGRhdGEtc3RvcnlpZD0iJHN0b3J5LlN0b3J5SWQiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCd2aWV3X21vcmVfY29tbWVudHMnKTwvYT4NCgkJPC9saT4NCgkjZW5kDQoNCgkjaWYgKCRjb2xsYXBzZSkNCgkJPGxpIGNsYXNzPSJjb250ZW50LWl0ZW0gYWN0aW9uIGNvbGxhcHNlZC1jb21tZW50cyI+DQoJCQk8YSBocmVmPSIjIj4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgndmlld19tb3JlX2NvbW1lbnRzJyk8L2E+DQoJCTwvbGk+DQoJI2VuZA0KDQoJI2ZvcmVhY2ggKCRjb21tZW50IGluICRjb21tZW50cykNCgkJI3NldCAoJGFjY2Vzc2luZ1VzZXJDYW5EZWxldGUgPSAkY29yZV92Ml9jb21tZW50cy5DYW5EZWxldGVDb21tZW50KCRjb21tZW50LkNvbW1lbnRJZCkpDQoJCTxsaSBjbGFzcz0iY29udGVudC1pdGVtIGNvbW1lbnQgI2lmICgkY29sbGFwc2UgJiYgJGNvbGxhcHNlQ291bnQgPCAoJGNvbW1lbnRzLkNvdW50IC0gJHNob3dXaGVuQ29sbGFwc2VkKSkgY29sbGFwc2UgI2VuZCIgZGF0YS1jb21tZW50aWQ9IiQhY29tbWVudC5Db21tZW50SWQiIGRhdGEtY29tbWVudGRhdGU9IiQhY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXREYXRlKCRjb21tZW50LkNyZWF0ZWREYXRlLCAkZGF0ZVRpbWVSb3VuZFRyaXBGb3JtYXQpIj4NCgkJCTxkaXYgY2xhc3M9ImZ1bGwtcG9zdC1oZWFkZXIgY29tbWVudCI+PC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJmdWxsLXBvc3QgY29tbWVudCI+DQoNCgkJCQk8ZGl2IGNsYXNzPSJwb3N0LWF1dGhvciI+DQoJCQkJCTxzcGFuIGNsYXNzPSJhdmF0YXIiPg0KCQkJCQkJI2lmKCRjb21tZW50LlVzZXIuUHJvZmlsZVVybCkNCgkJCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRjb21tZW50LlVzZXIuUHJvZmlsZVVybCkiPg0KCQkJCQkJCQkkY29yZV92Ml91aS5HZXRSZXNpemVkSW1hZ2VIdG1sKCRjb21tZW50LlVzZXIuQXZhdGFyVXJsLCAzMiwgMzIsICIle2JvcmRlcj0nMCcsUmVzaXplTWV0aG9kID0gJ1pvb21BbmRDcm9wJywgYWx0PSRjb21tZW50LlVzZXIuRGlzcGxheU5hbWV9IikNCgkJCQkJCQk8L2E+DQoJCQkJCQkjZWxzZQ0KCQkJCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJGNvbW1lbnQuVXNlci5BdmF0YXJVcmwsIDMyLCAzMiwgIiV7Ym9yZGVyPScwJyxSZXNpemVNZXRob2QgPSAnWm9vbUFuZENyb3AnLCBhbHQ9JGNvbW1lbnQuVXNlci5EaXNwbGF5TmFtZX0iKQ0KCQkJCQkJI2VuZA0KCQkJCQk8L3NwYW4+DQoJCQkJCTxzcGFuIGNsYXNzPSJ1c2VyLW5hbWUiPg0KCQkJCQkJI2lmKCRjb21tZW50LlVzZXIuUHJvZmlsZVVybCkNCgkJCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRjb21tZW50LlVzZXIuUHJvZmlsZVVybCkiIGNsYXNzPSJpbnRlcm5hbC1saW5rIHZpZXctdXNlci1wcm9maWxlIj48c3Bhbj48L3NwYW4+JGNvbW1lbnQuVXNlci5EaXNwbGF5TmFtZTwvYT4NCgkJCQkJCSNlbHNlDQoJCQkJCQkJPHNwYW4+JGNvbW1lbnQuVXNlci5EaXNwbGF5TmFtZTwvc3Bhbj4NCgkJCQkJCSNlbmQNCgkJCQkJPC9zcGFuPg0KCQkJCTwvZGl2Pg0KDQoJCQkJI2lmICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCkNCgkJCQkJI3NldCAoJG1vZGVyYXRlT3B0aW9ucyA9ICIle30iKQ0KCQkJCQkjaWYoJGFjY2Vzc2luZ1VzZXJDYW5EZWxldGUpDQoJCQkJCQkjc2V0ICgkRFEgPSAnIicpDQoJCQkJCQkkbW9kZXJhdGVPcHRpb25zLkFkZCgnQWRkaXRpb25hbExpbmtzJywiW3ske0RRfWhyZWYke0RRfToke0RRfSMke0RRfSwke0RRfXRleHQke0RRfToke0RRfSR7Y29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnZGVsZXRlJyl9JHtEUX0sJHtEUX1jbGFzc05hbWUke0RRfToke0RRfWRlbGV0ZSR7RFF9fV0iKQ0KCQkJCQkjZW5kDQoJCQkJCTxkaXYgY2xhc3M9InBvc3QtbW9kZXJhdGUiPg0KCQkJCQkJJGNvcmVfdjJfdWkuTW9kZXJhdGUoJGNvbW1lbnQuQ29tbWVudElkLCAkY29tbWVudC5Db21tZW50Q29udGVudFR5cGVJZCwgJG1vZGVyYXRlT3B0aW9ucykNCgkJCQkJPC9kaXY+DQoJCQkJI2VuZA0KDQoJCQkJPGRpdiBjbGFzcz0icG9zdC1jb250ZW50IHVzZXItZGVmaW5lZC1tYXJrdXAiPg0KCQkJCQkkY29tbWVudC5Cb2R5KCkNCgkJCQk8L2Rpdj4NCg0KCQkJCTxkaXYgY2xhc3M9InBvc3QtYWN0aW9ucyI+DQoJCQkJCTxkaXYgY2xhc3M9Im5hdmlnYXRpb24tbGlzdC1oZWFkZXIiPjwvZGl2Pg0KCQkJCQk8dWwgY2xhc3M9Im5hdmlnYXRpb24tbGlzdCI+DQoJCQkJCQk8bGkgY2xhc3M9Im5hdmlnYXRpb24taXRlbSI+DQoJCQkJCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0QWdvRGF0ZSgkY29tbWVudC5DcmVhdGVkRGF0ZSkNCgkJCQkJCTwvbGk+DQoJCQkJCQkjaWYgKCRjb3JlX3YyX2xpa2UuQ2FuTGlrZSgkY29tbWVudC5Db21tZW50SWQsICRjb21tZW50LkNvbW1lbnRDb250ZW50VHlwZUlkKSkNCgkJCQkJCQk8bGkgY2xhc3M9Im5hdmlnYXRpb24taXRlbSI+DQoJCQkJCQkJCSNpZiAoJGFjY2Vzc2luZ1VzZXJJc1JlZ2lzdGVyZWQpDQoJCQkJCQkJCQkkY29yZV92Ml91aS5MaWtlKCRjb21tZW50LkNvbW1lbnRJZCwgJGNvbW1lbnQuQ29tbWVudENvbnRlbnRUeXBlSWQsICIleyBGb3JtYXQgPSAne3RvZ2dsZX0nIH0iKQ0KCQkJCQkJCQkjZWxzZQ0KCQkJCQkJCQkJI3NldCAoJERRID0gJyInKQ0KCQkJCQkJCQkJJGNvcmVfdjJfdWkuTGlrZSgkY29tbWVudC5Db21tZW50SWQsICRjb21tZW50LkNvbW1lbnRDb250ZW50VHlwZUlkLCAiJXsgRm9ybWF0ID0gJzxzcGFuIGNsYXNzPSR7RFF9bGlrZS1pbmRpY2F0b3IgaW5saW5lJHtEUX0+PC9zcGFuPntjb3VudH0nIH0iKQ0KCQkJCQkJCQkjZW5kDQoJCQkJCQkJPC9saT4NCgkJCQkJCSNlbmQNCgkJCQkJPC91bD4NCgkJCQkJPGRpdiBjbGFzcz0ibmF2aWdhdGlvbi1saXN0LWZvb3RlciI+PC9kaXY+DQoJCQkJPC9kaXY+DQoJCQk8L2Rpdj4NCgkJCTxkaXYgY2xhc3M9ImZ1bGwtcG9zdC1mb290ZXIgY29tbWVudCI+PC9kaXY+DQoJCTwvbGk+DQoNCgkJI3NldCAoJGNvbGxhcHNlQ291bnQgPSAkY29sbGFwc2VDb3VudCArIDEpDQoJI2VuZA0KDQoJIyMgb25seSBzaG93IGNvbW1lbnQgZm9ybSBhcyBwYXJ0IG9mIHRoZSBmaXJzdCAoaW5pdGlhbCkgcGFnZSBvZiBjb21tZW50cw0KCSNpZiAoJGFjY2Vzc2luZ1VzZXJDYW5Db21tZW50ICYmICRjb21tZW50UGFnZUluZGV4ID09IDApDQoJCTxsaSBjbGFzcz0iY29udGVudC1pdGVtIGNvbW1lbnQgY29tbWVudC1mb3JtIiAjaWYoJHJldmVyc2VkQ29tbWVudHMuVG90YWxDb3VudCA9PSAwKXN0eWxlPSJkaXNwbGF5Om5vbmU7IiNlbmQ+DQoJCQk8ZGl2IGNsYXNzPSJmaWVsZC1saXN0LWhlYWRlciI+PC9kaXY+DQoJCQk8ZmllbGRzZXQgY2xhc3M9ImZpZWxkLWxpc3QiPg0KCQkJCTx1bCBjbGFzcz0iZmllbGQtbGlzdCI+DQoJCQkJCTxsaSBjbGFzcz0iZmllbGQtaXRlbSI+DQoJCQkJCQk8c3BhbiBjbGFzcz0iZmllbGQtaXRlbS1pbnB1dCI+DQoJCQkJCQkJPHNwYW4gY2xhc3M9ImF2YXRhciI+DQoJCQkJCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJGFjY2Vzc2luZ1VzZXIuQXZhdGFyVXJsLCAzMiwgMzIsICIle2FsdD0kYWNjZXNzaW5nVXNlci5EaXNwbGF5TmFtZSxzdHlsZT0nYm9yZGVyLXdpZHRoOjA7JywgUmVzaXplTWV0aG9kID0gJ1pvb21BbmRDcm9wJ30iKQ0KCQkJCQkJCTwvc3Bhbj4NCgkJCQkJCQk8dGV4dGFyZWEgcm93cz0iMSIgbWF4bGVuZ3RoPSIkY29yZV92Ml9jb25maWd1cmF0aW9uLkFjdGl2aXR5TWVzc2FnZVJlcGx5TWF4TGVuZ3RoIiBwbGFjZWhvbGRlcj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnd3JpdGVDb21tZW50JykpIj48L3RleHRhcmVhPg0KCQkJCQkJPC9zcGFuPg0KCQkJCQk8L2xpPg0KCQkJCTwvdWw+DQoJCQk8L2ZpZWxkc2V0Pg0KCQkJPGRpdiBjbGFzcz0iZmllbGQtbGlzdC1mb290ZXIiPjwvZGl2Pg0KCQk8L2xpPg0KCSNlbmQNCiNlbmQNCg==</file><file name="morecomments.vm">I3NldCAoJGNvbW1lbnRQYWdlSW5kZXggPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlSW50KCRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19jb21tZW50UGFnZUluZGV4JykpKQ0KI3NldCAoJHN0b3J5SWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlR3VpZCgkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfc3RvcnlJZCcpKSkNCiRjb3JlX3YyX3dpZGdldC5FeGVjdXRlRmlsZSgnY29tbWVudHMudm0nKQ0K</file><file name="story.vm">IyMNCiMjIFJlbmRlcnMgYW4gaW5kaXZpZHVhbCBhY3Rpdml0eSBzdG9yeQ0KIyMgUmVxdWlyZXMgaW4gc2NvcGU6DQojIyAgICRzdG9yeSBpbnN0YW5jZQ0KIyMNCg0KI3NldCAoJHdpZGdldFVuaXF1ZU1lc3NhZ2VJZCA9ICIke2NvcmVfdjJfd2lkZ2V0LldyYXBwZXJFbGVtZW50SWR9X3N0b3J5XyR7bWVzc2FnZS5TdG9yeUlkfSIpDQoNCiNzZXQgKCRwcmltYXJ5U3RvcnlVc2VyID0gJHN0b3J5LlByaW1hcnlVc2VyKQ0KDQojc2V0ICgkcHJpbWFyeVN0b3J5VXNlcklzUmVnaXN0ZXJlZCA9IGZhbHNlKQ0KI3NldCAoJHByaW1hcnlTdG9yeVVzZXJJc1JlZ2lzdGVyZWQgPSAkY29yZV92Ml91c2VyLklzUmVnaXN0ZXJlZCgkcHJpbWFyeVN0b3J5VXNlci5JZCkpDQojc2V0ICgkcHJpbWFyeVN0b3J5VXNlcklzQWNjZXNzaW5nVXNlciA9IGZhbHNlKQ0KI2lmICgkYWNjZXNzaW5nVXNlci5JZCA9PSAkcHJpbWFyeVN0b3J5VXNlci5JZCkNCgkjc2V0ICgkcHJpbWFyeVN0b3J5VXNlcklzQWNjZXNzaW5nVXNlciA9IHRydWUpDQojZW5kDQoNCiNzZXQgKCRjb21tZW50c1N1cHBvcnRlZCA9IGZhbHNlKQ0KI3NldCAoJGNvbW1lbnRzU3VwcG9ydGVkID0gJGNvcmVfdjJfY29tbWVudHMuU3VwcG9ydHNDb21tZW50cygkc3RvcnkuQ29udGVudFR5cGVJZCkpDQoNCiNzZXQgKCRhY2Nlc3NpbmdVc2VyQ2FuQ29tbWVudCA9IGZhbHNlKQ0KI2lmICgkY29tbWVudHNTdXBwb3J0ZWQpDQoJI3NldCAoJGFjY2Vzc2luZ1VzZXJDYW5Db21tZW50ID0gJGNvcmVfdjJfY29tbWVudHMuQ2FuQ3JlYXRlQ29tbWVudCgkc3RvcnkuQ29udGVudElkLCAkc3RvcnkuQ29udGVudFR5cGVJZCkpDQojZW5kDQoNCiNzZXQgKCR3aWRnZXRVbmlxdWVTdG9yeUlkID0gIiR7Y29yZV92Ml93aWRnZXQuV3JhcHBlckVsZW1lbnRJZH1fc3RvcnlfJHtzdG9yeS5TdG9yeUlkfSIpDQojc2V0ICgkc3RvcnlUeXBlID0gJHN0b3J5LlN0b3J5VHlwZUlkKQ0KDQo8bGkgaWQ9IiQhd2lkZ2V0VW5pcXVlU3RvcnlJZCIgY2xhc3M9ImNvbnRlbnQtaXRlbSBhY3Rpdml0eSBhY3Rpdml0eS1zdG9yeSAkIXN0b3J5VHlwZSIgZGF0YS1hdXRob3JpZD0iJCFsYXRlc3RBY3Rvci5Vc2VyLklkIiBkYXRhLWFjdGl2aXR5aWQ9IiQhc3RvcnkuU3RvcnlJZCIgZGF0YS1hY3Rpdml0eXR5cGU9IiQhc3RvcnlUeXBlIiBkYXRhLWFjdGl2aXR5ZGF0ZT0iJCFjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdERhdGUoJHN0b3J5Lkxhc3RVcGRhdGUsICRkYXRlVGltZVJvdW5kVHJpcEZvcm1hdCkiIGRhdGEtY29udGVudGlkPSIkIXN0b3J5LkNvbnRlbnRJZCIgZGF0YS1jb250ZW50dHlwZWlkPSIkIXN0b3J5LkNvbnRlbnRUeXBlSWQiIGRhdGEtdHlwZWlkPSIkIXN0b3J5LlR5cGVJZCI+DQoJPGRpdiBjbGFzcz0iZnVsbC1wb3N0LWhlYWRlciBhY3Rpdml0eSI+PC9kaXY+DQoJPGRpdiBjbGFzcz0iZnVsbC1wb3N0IGFjdGl2aXR5Ij4NCgkJPGRpdiBjbGFzcz0icG9zdC1hdXRob3IgYWN0aXZpdHkiPg0KCQkJPHNwYW4gY2xhc3M9ImF2YXRhciI+DQoJCQkJI2lmKCRwcmltYXJ5U3RvcnlVc2VyLlByb2ZpbGVVcmwpDQoJCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJHByaW1hcnlTdG9yeVVzZXIuUHJvZmlsZVVybCkiIGNsYXNzPSJpbnRlcm5hbC1saW5rIHZpZXctdXNlci1wcm9maWxlIj4NCgkJCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJHByaW1hcnlTdG9yeVVzZXIuQXZhdGFyVXJsLCA1MCwgNTAsICIle2JvcmRlcj0nMCcsUmVzaXplTWV0aG9kID0gJ1pvb21BbmRDcm9wJywgYWx0PSRwcmltYXJ5U3RvcnlVc2VyLkRpc3BsYXlOYW1lfSIpDQoJCQkJCTwvYT4NCgkJCQkjZWxzZQ0KCQkJCQkkY29yZV92Ml91aS5HZXRSZXNpemVkSW1hZ2VIdG1sKCRwcmltYXJ5U3RvcnlVc2VyLkF2YXRhclVybCwgNTAsIDUwLCAiJXtib3JkZXI9JzAnLFJlc2l6ZU1ldGhvZCA9ICdab29tQW5kQ3JvcCcsIGFsdD0kcHJpbWFyeVN0b3J5VXNlci5EaXNwbGF5TmFtZX0iKQ0KCQkJCSNlbmQNCgkJCTwvc3Bhbj4NCgkJPC9kaXY+DQoNCgkJI2lmICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCkNCgkJCSNzZXQgKCRtb2RlcmF0ZU9wdGlvbnMgPSAiJXt9IikNCgkJCSNpZigkY29yZV92Ml9hY3Rpdml0eVN0b3J5LkNhbkRlbGV0ZSgkc3RvcnkuU3RvcnlJZCkpDQoJCQkJI3NldCAoJERRID0gJyInKQ0KCQkJCSRtb2RlcmF0ZU9wdGlvbnMuQWRkKCdBZGRpdGlvbmFsTGlua3MnLCJbeyR7RFF9aHJlZiR7RFF9OiR7RFF9IyR7RFF9LCR7RFF9dGV4dCR7RFF9OiR7RFF9JHtjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdkZWxldGUnKX0ke0RRfSwke0RRfWNsYXNzTmFtZSR7RFF9OiR7RFF9ZGVsZXRlJHtEUX19XSIpDQoJCQkjZW5kDQoJCQk8ZGl2IGNsYXNzPSJwb3N0LW1vZGVyYXRlIj4NCgkJCQkkY29yZV92Ml91aS5Nb2RlcmF0ZSgkc3RvcnkuQ29udGVudElkLCAkc3RvcnkuQ29udGVudFR5cGVJZCwgJG1vZGVyYXRlT3B0aW9ucykNCgkJCTwvZGl2Pg0KCQkjZW5kDQoNCgkJPGRpdiBjbGFzcz0icG9zdC1jb250ZW50IGFjdGl2aXR5Ij4NCgkJCSRzdG9yeS5WaWV3SHRtbCgnV2ViJykNCgkJPC9kaXY+DQoNCgkJPGRpdiBjbGFzcz0icG9zdC1hY3Rpb25zIGFjdGl2aXR5Ij4NCgkJCTxkaXYgY2xhc3M9Im5hdmlnYXRpb24tbGlzdC1oZWFkZXIiPjwvZGl2Pg0KCQkJPHVsIGNsYXNzPSJuYXZpZ2F0aW9uLWxpc3QiPg0KCQkJCSNpZiAoJGFjY2Vzc2luZ1VzZXJJc1JlZ2lzdGVyZWQgJiYgJGNvcmVfdjJfbGlrZS5DYW5MaWtlKCRzdG9yeS5Db250ZW50SWQsICRzdG9yeS5Db250ZW50VHlwZUlkKSkNCgkJCQkJPGxpIGNsYXNzPSJuYXZpZ2F0aW9uLWl0ZW0iPg0KCQkJCQkJI3NldCAoJGxpa2VPcHRpb25zID0gIiV7IEZvcm1hdCA9ICd7dG9nZ2xlfScgfSIpDQoJCQkJCQkjaWYgKCRzdG9yeS5UeXBlSWQpDQoJCQkJCQkJJGxpa2VPcHRpb25zLkFkZCgnTGlrZVR5cGVJZCcsICRzdG9yeS5UeXBlSWQpDQoJCQkJCQkjZW5kDQoJCQkJCQkkY29yZV92Ml91aS5MaWtlKCRzdG9yeS5Db250ZW50SWQsICRzdG9yeS5Db250ZW50VHlwZUlkLCAkbGlrZU9wdGlvbnMpDQoJCQkJCTwvbGk+DQoJCQkJI2VuZA0KDQoJCQkJI2lmICgkY29tbWVudHNTdXBwb3J0ZWQgJiYgJGFjY2Vzc2luZ1VzZXJDYW5Db21tZW50KQ0KCQkJCQk8bGkgY2xhc3M9Im5hdmlnYXRpb24taXRlbSI+DQoJCQkJCQk8YSBjbGFzcz0iaW50ZXJuYWwtbGluayBjb21tZW50IiBocmVmPSIjIj4NCgkJCQkJCQk8c3Bhbj48L3NwYW4+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ2NvbW1lbnQnKQ0KCQkJCQkJPC9hPg0KCQkJCQk8L2xpPg0KCQkJCSNlbmQNCg0KCQkJCTxsaSBjbGFzcz0ibmF2aWdhdGlvbi1pdGVtIj4NCgkJCQkJI3NldCAoJHN0b3J5VXJsID0gZmFsc2UpDQoJCQkJCSNzZXQgKCRzdG9yeVVybCA9ICRzdG9yeS5BY3Rpdml0eVVybCkNCgkJCQkJI2lmICgkc3RvcnlVcmwpDQoJCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRzdG9yeVVybCkiIGNsYXNzPSJpbnRlcm5hbC1saW5rIHZpZXctcG9zdCI+DQoJCQkJCQkJPHNwYW4gY2xhc3M9InBvc3QtZGF0ZSI+JGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0QWdvRGF0ZSgkc3RvcnkuQ3JlYXRlZERhdGUpPC9zcGFuPg0KCQkJCQkJPC9hPg0KCQkJCQkjZWxzZQ0KCQkJCQkJPHNwYW4gY2xhc3M9InBvc3QtZGF0ZSI+JGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0QWdvRGF0ZSgkc3RvcnkuQ3JlYXRlZERhdGUpPC9zcGFuPg0KCQkJCQkjZW5kDQoJCQkJPC9saT4NCgkJCTwvdWw+DQoJCQk8ZGl2IGNsYXNzPSJuYXZpZ2F0aW9uLWxpc3QtZm9vdGVyIj48L2Rpdj4NCgkJPC9kaXY+DQoNCgkJPGRpdiBjbGFzcz0iY29udGVudC1saXN0LWhlYWRlciBjb21tZW50cyI+PC9kaXY+DQoJCTxkaXYgY2xhc3M9ImNvbnRlbnQtbGlzdC1uYW1lIGNvbW1lbnRzIj48L2Rpdj4NCgkJPHVsIGNsYXNzPSJjb250ZW50LWxpc3QgY29tbWVudHMiPg0KCQkjIyBsaWtlcw0KCQkjc2V0ICgkbGlrZXMgPSBmYWxzZSkNCgkJI3NldCAoJGxpa2VMaXN0T3B0aW9ucyA9ICIleyBDb250ZW50SWQgPSAkc3RvcnkuQ29udGVudElkLCBDb250ZW50VHlwZUlkID0gJHN0b3J5LkNvbnRlbnRUeXBlSWQsIFBhZ2VTaXplID0gMSB9IikNCgkJI2lmICgkc3RvcnkuVHlwZUlkKQ0KCQkJJGxpa2VMaXN0T3B0aW9ucy5BZGQoJ1R5cGVJZCcsICRzdG9yeS5UeXBlSWQpDQoJCSNlbmQNCgkJI3NldCAoJGxpa2VzID0gJGNvcmVfdjJfbGlrZS5MaXN0KCRsaWtlTGlzdE9wdGlvbnMpKQ0KCQkjc2V0ICgkRFEgPSAnIicpDQoJCSNzZXQgKCRsaWtlT3B0aW9ucyA9ICIleyBGb3JtYXQgPSAnPHNwYW4gY2xhc3M9JHtEUX1saWtlLWluZGljYXRvciR7RFF9Pjwvc3Bhbj57bWVzc2FnZX0nIH0iKQ0KCQkjaWYgKCRzdG9yeS5UeXBlSWQpDQoJCQkkbGlrZU9wdGlvbnMuQWRkKCdMaWtlVHlwZUlkJywgJHN0b3J5LlR5cGVJZCkNCgkJI2VuZA0KCQkjaWYgKCRsaWtlcyAmJiAkbGlrZXMuVG90YWxDb3VudCA+IDApDQoJCQk8bGkgY2xhc3M9ImNvbnRlbnQtaXRlbSBhY3Rpb24gbGlrZXMgd2l0aC1saWtlcyI+DQoJCQkJJGNvcmVfdjJfdWkuTGlrZSgkc3RvcnkuQ29udGVudElkLCAkc3RvcnkuQ29udGVudFR5cGVJZCwgJGxpa2VPcHRpb25zKQ0KCQkJPC9saT4NCgkJI2Vsc2UNCgkJCTxsaSBjbGFzcz0iY29udGVudC1pdGVtIGFjdGlvbiBsaWtlcyB3aXRob3V0LWxpa2VzIj4NCgkJCQkkY29yZV92Ml91aS5MaWtlKCRzdG9yeS5Db250ZW50SWQsICRzdG9yeS5Db250ZW50VHlwZUlkLCAkbGlrZU9wdGlvbnMpDQoJCQk8L2xpPg0KCQkjZW5kDQoJCSNpZiAoJGNvbW1lbnRzU3VwcG9ydGVkKQ0KCQkJI3NldCAoJGNvbW1lbnRQYWdlSW5kZXggPSAwKQ0KCQkJJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdjb21tZW50cy52bScpDQoJCSNlbmQNCgkJPC91bD4NCgkJPGRpdiBjbGFzcz0iY29udGVudC1saXN0LWZvb3RlciBjb21tZW50cyI+PC9kaXY+DQoJPC9kaXY+DQoJPGRpdiBjbGFzcz0iZnVsbC1wb3N0LWZvb3RlciBhY3Rpdml0eSI+PC9kaXY+DQo8L2xpPg0K</file><file name="stream.vm">I3NldCAoJGNvbGxhcHNlV2hlbk92ZXIgPSA0KQ0KI3NldCAoJHNob3dXaGVuQ29sbGFwc2VkID0gMikNCiNzZXQgKCRleGNlcnB0U2l6ZSA9IDUwMCkNCiNzZXQgKCRwb3N0Q29tbWVudFBhZ2VTaXplID0gMjApDQojc2V0ICgkZGF0ZVRpbWVSb3VuZFRyaXBGb3JtYXQgPSAieXl5eS1NTS1kZFRISDptbTpzcyIpDQoNCiNzZXQgKCRmaWx0ZXJUeXBlID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X2ZpbHRlclR5cGUnKSkNCiNzZXQgKCRmaWx0ZXJJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19maWx0ZXJJbmRleCcpKQ0KI3NldCAoJHBhZ2VTaXplID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfcGFnZVNpemUnKSkpDQoNCiNzZXQgKCRlbmREYXRlID0gZmFsc2UpDQojaWYgKCRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19lbmREYXRlJykubGVuZ3RoID4gMCkNCgkjc2V0KCRlbmREYXRlID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZURhdGUoJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X2VuZERhdGUnKSkpDQojZW5kDQoNCiNzZXQoJHN0b3J5SWQgPSBmYWxzZSkNCiNpZiAoJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X21lc3NhZ2VJZCcpKQ0KCSNzZXQgKCRzaW5nbGVTdG9yeSA9IHRydWUpDQoJI3NldCAoJHN0b3J5SWQgPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfbWVzc2FnZUlkJykpDQojZW5kDQoNCiNzZXQgKCRpc0FkbWluaXN0cmF0b3IgPSBmYWxzZSkNCiNpZiAoJGNvcmVfdjJfbm9kZVBlcm1pc3Npb24uR2V0KCdTaXRlX01vZGVyYXRlVXNlckNvbnRlbnQnKS5Jc0FsbG93ZWQpDQoJI3NldCgkaXNBZG1pbmlzdHJhdG9yID0gdHJ1ZSkNCiNlbmQNCg0KI3NldCAoJGFjY2Vzc2luZ1VzZXIgPSAkY29yZV92Ml91c2VyLkFjY2Vzc2luZykNCiNzZXQgKCRhY2Nlc3NpbmdVc2VySXNSZWdpc3RlcmVkID0gZmFsc2UpDQojaWYgKCRjb3JlX3YyX3VzZXIuSXNSZWdpc3RlcmVkKCRhY2Nlc3NpbmdVc2VyLklkKSkNCgkjc2V0ICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCA9IHRydWUpDQojZW5kDQoNCiMjIGdldCBmaWx0ZXIgY29uZmlndXJhdGlvbiBjb3JyZXNwb25kaW5nIHRvIHNlbGVjdGVkIGZpbHRlciB0YWIgaW5kZXgNCiNpZiAoJGZpbHRlclR5cGUgPT0gJ1VzZXInKQ0KCSNzZXQgKCRmaWx0ZXJBY3Rpdml0eVR5cGVzUHJvcGVydHkgPSAiZmlsdGVyVXNlckFjdGl2aXR5VHlwZXMke2ZpbHRlckluZGV4fSIpDQojZWxzZQ0KCSNzZXQgKCRmaWx0ZXJBY3Rpdml0eVR5cGVzUHJvcGVydHkgPSAiZmlsdGVyQWN0aXZpdHlUeXBlcyR7ZmlsdGVySW5kZXh9IikNCiNlbmQNCiNzZXQgKCRmaWx0ZXJBY3Rpdml0eVR5cGVzID0gZmFsc2UpDQojc2V0ICgkZmlsdGVyQWN0aXZpdHlUeXBlcyA9ICRjb3JlX3YyX3BhZ2UuUGFyc2VRdWVyeVN0cmluZygkY29yZV92Ml93aWRnZXQuR2V0Q3VzdG9tVmFsdWUoJGZpbHRlckFjdGl2aXR5VHlwZXNQcm9wZXJ0eSwnJykpKQ0KDQojIyBzdG9yaWVzDQojc2V0KCRzdG9yaWVzID0gZmFsc2UpDQoNCiNpZiAoJHN0b3J5SWQpICAjIyBpbmRpdmlkdWFsIHN0b3J5IGlkDQoJI3NldCAoJHN0b3J5ID0gZmFsc2UpDQoJI3NldCAoJHN0b3J5SWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlR3VpZCgkc3RvcnlJZCkpDQoJI3NldCAoJHN0b3J5ID0gJGNvcmVfdjJfYWN0aXZpdHlTdG9yeS5HZXQoJHN0b3J5SWQpKQ0KCSNpZiAoJHN0b3J5KQ0KCQkjc2V0ICgkc3RvcmllcyA9IFskc3RvcnldKQ0KCSNlbHNlDQoJCSNzZXQgKCRzdG9yaWVzID0gW10pDQoJI2VuZA0KI2Vsc2VpZiAoJGZpbHRlclR5cGUgPT0gJ1VzZXInKSAjIyB1c2VyIGlkDQoJI3NldCAoJHF1ZXJ5ID0gIiV7IFNvcnRCeSA9ICdEYXRlJywgU29ydE9yZGVyID0gJ0Rlc2NlbmRpbmcnLCBQYWdlU2l6ZSA9ICRwYWdlU2l6ZSB9IikNCiNlbHNlaWYgKCRmaWx0ZXJUeXBlID09ICdHcm91cCcpICMjIGdyb3VwDQoJI3NldCAoJGN1cnJlbnRHcm91cCA9IGZhbHNlKQ0KCSNzZXQgKCRjdXJyZW50R3JvdXAgPSAkY29yZV92Ml9ncm91cC5DdXJyZW50KQ0KCSNzZXQgKCRpbmNsdWRlU3ViR3JvdXBzID0gJGNvcmVfdjJfd2lkZ2V0LkdldEJvb2xWYWx1ZSgnaW5jbHVkZVN1Ykdyb3VwcycsIGZhbHNlKSkNCgkjc2V0ICgkY29udGFpbmVySWRzID0gIiIpDQoJI2lmICgkY3VycmVudEdyb3VwKQ0KCQkjc2V0ICgkY29udGFpbmVySWRzID0gIiRjdXJyZW50R3JvdXAuQ29udGFpbmVySWQiKQ0KCSNpZiAoJGluY2x1ZGVTdWJHcm91cHMpDQoJCSNzZXQgKCRzdWJHcm91cHMgPSAkY29yZV92Ml9ncm91cC5MaXN0KCIleyBJbmNsdWRlQWxsU3ViR3JvdXBzID0gJ3RydWUnLCBQYWdlU2l6ZSA9IDUwLCBQYXJlbnRHcm91cElkID0gJGN1cnJlbnRHcm91cC5JZCwgUGVybWlzc2lvbiA9ICdHcm91cF9SZWFkR3JvdXAnIH0iKSkNCgkJI2ZvcmVhY2ggKCRzdWJHcm91cCBpbiAkc3ViR3JvdXBzKQ0KCQkJI3NldCAoJGNvbnRhaW5lcklkcyA9ICIke2NvbnRhaW5lcklkc30sJHtzdWJHcm91cC5Db250YWluZXJJZH0iKQ0KCQkjZW5kDQoJI2VuZA0KCSNlbmQNCgkjc2V0ICgkcXVlcnkgPSAiJXsgU29ydEJ5ID0gJ0RhdGUnLCBTb3J0T3JkZXIgPSAnRGVzY2VuZGluZycsIFBhZ2VTaXplID0gJHBhZ2VTaXplLCBDb250YWluZXJJZHMgPSAkY29udGFpbmVySWRzIH0iKQ0KI2Vsc2UgICMjIHNpdGUNCgkjc2V0ICgkcXVlcnkgPSAiJXsgU29ydEJ5ID0gJ0RhdGUnLCBTb3J0T3JkZXIgPSAnRGVzY2VuZGluZycsIFBhZ2VTaXplID0gJHBhZ2VTaXplIH0iKQ0KI2VuZA0KDQojaWYgKCEkc3RvcmllcykNCgkjIyBpbmNsdWRlIGZpbHRlcnMsIGlmIHNwZWNpZmllZA0KCSNzZXQgKCRoYXNVc2VyRmlsdGVycyA9IGZhbHNlKQ0KCSNpZiAoJGZpbHRlckFjdGl2aXR5VHlwZXMgJiYgJGZpbHRlckFjdGl2aXR5VHlwZXMuVmFsdWVzKCdmaWx0ZXJzJykuQ291bnQgPiAwKQ0KCQkjc2V0ICgkaW5jbHVkZWRTdG9yeVR5cGVzID0gZmFsc2UpDQoJCSNzZXQgKCRpbmNsdWRlZFN0b3J5VHlwZXMgPSAkZmlsdGVyQWN0aXZpdHlUeXBlcy5WYWx1ZXMoJ2ZpbHRlcnMnKSkNCgkJI2ZvcmVhY2ggKCRzdG9yeVR5cGUgaW4gJGluY2x1ZGVkU3RvcnlUeXBlcykNCgkJCSNzZXQgKCRpbmNsdWRlZFVzZXJzID0gZmFsc2UpDQoJCQkjc2V0ICgkaW5jbHVkZWRVc2VycyA9ICRmaWx0ZXJBY3Rpdml0eVR5cGVzLlZhbHVlKCRzdG9yeVR5cGUpKQ0KCQkJI2lmICgkaW5jbHVkZWRVc2VycykNCgkJCQkjc2V0ICgkZmlsdGVyTmFtZSA9ICJfRmlsdGVyXyR7c3RvcnlUeXBlfSIpDQoJCQkJI3NldCAoJGhhc1VzZXJGaWx0ZXJzID0gdHJ1ZSkNCgkJCQkkcXVlcnkuQWRkKCRmaWx0ZXJOYW1lLCAkaW5jbHVkZWRVc2VycykNCgkJCSNlbmQNCgkJI2VuZA0KCSNlbmQNCg0KCSNpZiAoJGhhc1VzZXJGaWx0ZXJzIHx8ICRmaWx0ZXJUeXBlID09ICdVc2VyJykNCgkJI3NldCAoJHVzZXJJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X3VzZXJJZCcpKSkNCgkJJHF1ZXJ5LkFkZCgnVXNlcklkJywgJHVzZXJJZCkNCgkjZW5kDQoNCgkjIyBpbmNsdWRlIGRhdGUgb2Zmc2V0LCBpZiBzcGVjaWZpZWQNCgkjaWYgKCRlbmREYXRlKQ0KCQkkcXVlcnkuQWRkKCdFbmREYXRlJywgJGVuZERhdGUpDQoJI2VuZA0KCSNzZXQgKCRzdG9yaWVzID0gJGNvcmVfdjJfYWN0aXZpdHlTdG9yeS5MaXN0KCRxdWVyeSkpDQojZW5kDQoNCiNzZXQoJGhhZERhdGVGaWx0ZXIgPSBmYWxzZSkNCiNpZiAoISRlbmREYXRlKQ0KCSNzZXQoJGhhZERhdGVGaWx0ZXIgPSB0cnVlKQ0KI2VuZA0KI3NldCgkZW5kRGF0ZSA9IGZhbHNlKQ0KDQojZm9yZWFjaCgkc3RvcnkgaW4gJHN0b3JpZXMpDQojYmVmb3JlYWxsDQoJPHVsPg0KI2VhY2gNCgkjc2V0ICgkZW5kRGF0ZSA9ICRzdG9yeS5MYXN0VXBkYXRlKQ0KDQoJJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCJzdG9yeS52bSIpDQojbm9kYXRhDQoJI2lmICgkaGFkRGF0ZUZpbHRlcikNCgkJPHVsPg0KCQkJPGxpIGlkPSIke2NvcmVfdjJfd2lkZ2V0LldyYXBwZXJFbGVtZW50SWR9X21lc3NhZ2Vfbm9yZWNvcmRzIj48ZGl2IGNsYXNzPSJtZXNzYWdlIG5vcmVjb3JkcyI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ25vX21lc3NhZ2VzJyk8L2Rpdj48L2xpPg0KCQk8L3VsPg0KCSNlbmQNCiNhZnRlcmFsbA0KCTxsaSBjbGFzcz0iZGF0YSIgZGF0YS1sYXN0bWVzc2FnZWRhdGU9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJGVuZERhdGUuQWRkTWlsbGlzZWNvbmRzKDEpLlRvU3RyaW5nKCRkYXRlVGltZVJvdW5kVHJpcEZvcm1hdCkpIj48L2xpPg0KCTwvdWw+DQojZW5kDQoNCg0K</file><file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCkgew0KDQoJdmFyIEFjdGl2aXR5U2VydmljZSA9IChmdW5jdGlvbigpew0KCSAgIHZhciBob2xkcyA9IDAsDQoJCQlsb2NrZWREYXRhS2V5ID0gJ19zdHJlYW1fbG9ja2VkX2Zvcl9jb21tZW50aW5nJywNCgkJCWxpc3RVcmw7DQoJCXJldHVybiB7DQoJCQlsb2NrOiBmdW5jdGlvbih0YSkgew0KCQkJCWlmKCEkKHRhKS5kYXRhKGxvY2tlZERhdGFLZXkpKSB7DQoJCQkJCSQodGEpLmRhdGEobG9ja2VkRGF0YUtleSwgdHJ1ZSk7DQoJCQkJCWhvbGRzKys7DQoJCQkJfQ0KCQkJfSwNCgkJCXVubG9jazogZnVuY3Rpb24odGEpIHsNCgkJCQlpZigkKHRhKS5kYXRhKGxvY2tlZERhdGFLZXkpKSB7DQoJCQkJCSQodGEpLmRhdGEobG9ja2VkRGF0YUtleSwgZmFsc2UpOw0KCQkJCQlob2xkcy0tOw0KCQkJCQlpZihob2xkcyA8IDApDQoJCQkJCQlob2xkcyA9IDA7DQoJCQkJfQ0KCQkJfSwNCgkJCWluaXQ6IGZ1bmN0aW9uKGNvbnRleHQpIHsNCgkJCQlsaXN0VXJsID0gY29udGV4dC5zdHJlYW1Vcmw7DQoJCQl9LA0KCQkJbGlzdDogZnVuY3Rpb24ocXVlcnksIHN1Y2Nlc3MsIGVycm9yKSB7DQoJCQkJaWYoaG9sZHMgPiAwKSB7DQoJCQkJCXJldHVybjsNCgkJCQl9DQoNCgkJCQl2YXIgZGF0YSA9IHt9Ow0KCQkJCSQuZWFjaChxdWVyeSwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgew0KCQkJCQlkYXRhWyd3XycgKyBrZXldID0gdmFsdWU7DQoJCQkJfSkNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsNCgkJCQkJdXJsOiBsaXN0VXJsLA0KCQkJCQlkYXRhOiBkYXRhLA0KCQkJCQljYWNoZTogZmFsc2UsDQoJCQkJCXN1Y2Nlc3M6IHN1Y2Nlc3MsDQoJCQkJCWVycm9yOiBlcnJvcg0KCQkJCX0pOw0KCQkJfSwNCgkJCWRlbDogZnVuY3Rpb24oaWQsIHN1Y2Nlc3MsIGVycm9yKSB7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLmRlbCh7DQoJCQkJCXVybDogJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL3N0b3JpZXMve1N0b3J5SWR9Lmpzb24nLA0KCQkJCQlkYXRhOiB7IFN0b3J5SWQ6IGlkIH0sDQoJCQkJCWNhY2hlOiBmYWxzZSwNCgkJCQkJc3VjY2Vzczogc3VjY2VzcywNCgkJCQkJZXJyb3I6IGVycm9yDQoJCQkJfSk7DQoJCQl9DQoJCX07DQoJfSgpKTsNCg0KCXZhciBSZXBseVNlcnZpY2UgPSAoZnVuY3Rpb24oKXsNCgkJdmFyIGxpc3RVcmw7DQoJCXJldHVybiB7DQoJCQlpbml0OiBmdW5jdGlvbihjb250ZXh0KSB7DQoJCQkJbGlzdFVybCA9IGNvbnRleHQubW9yZUNvbW1lbnRzVXJsOw0KCQkJfSwNCgkJCWFkZDogZnVuY3Rpb24oYWN0aXZpdHlFbGVtZW50LCBjb21tZW50LCBzdWNjZXNzLCBmYWlsKSB7DQoJCQkJdmFyIGRhdGEgPSB7DQoJCQkJCQlDb250ZW50SWQ6IGFjdGl2aXR5RWxlbWVudC5kYXRhKCdjb250ZW50aWQnKSwNCgkJCQkJCUNvbnRlbnRUeXBlSWQ6IGFjdGl2aXR5RWxlbWVudC5kYXRhKCdjb250ZW50dHlwZWlkJyksDQoJCQkJCQlCb2R5OiBjb21tZW50DQoJCQkJCX07DQoNCgkJCQlpZiAoYWN0aXZpdHlFbGVtZW50LmRhdGEoJ3R5cGVpZCcpKSB7DQoJCQkJCWRhdGEuQ29tbWVudFR5cGVJZCA9IGFjdGl2aXR5RWxlbWVudC5kYXRhKCd0eXBlaWQnKTsNCgkJCQl9DQoNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ucG9zdCh7DQoJCQkJCXVybDogJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL2NvbW1lbnRzLmpzb24nLA0KCQkJCQlkYXRhOiBkYXRhLA0KCQkJCQljYWNoZTogZmFsc2UsDQoJCQkJCXN1Y2Nlc3M6IHN1Y2Nlc3MsDQoJCQkJCWVycm9yOiBmYWlsDQoJCQkJfSk7DQoJCQl9LA0KCQkJZGVsOiBmdW5jdGlvbihhY3Rpdml0eUVsZW1lbnQsIGNvbW1lbnQsIHN1Y2Nlc3MsIGZhaWwpIHsNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZGVsKHsNCgkJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvY29tbWVudHMve0NvbW1lbnRJZH0uanNvbicsDQoJCQkJCWRhdGE6IHsNCgkJCQkJCUNvbW1lbnRJZDogY29tbWVudC5kYXRhKCdjb21tZW50aWQnKQ0KCQkJCQl9LA0KCQkJCQljYWNoZTogZmFsc2UsDQoJCQkJCXN1Y2Nlc3M6IHN1Y2Nlc3MsDQoJCQkJCWVycm9yOiBmYWlsDQoJCQkJfSk7DQoJCQl9LA0KCQkJbGlzdDogZnVuY3Rpb24ocXVlcnksIHN1Y2Nlc3MsIGZhaWwpIHsNCgkJCQl2YXIgZGF0YSA9IHt9Ow0KCQkJCSQuZWFjaChxdWVyeSwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgew0KCQkJCQlkYXRhWyd3XycgKyBrZXldID0gdmFsdWU7DQoJCQkJfSkNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsNCgkJCQkJdXJsOiBsaXN0VXJsLA0KCQkJCQlkYXRhOiBkYXRhLA0KCQkJCQljYWNoZTogZmFsc2UsDQoJCQkJCXN1Y2Nlc3M6IHN1Y2Nlc3MsDQoJCQkJCWVycm9yOiBmYWlsDQoJCQkJfSk7DQoJCQl9DQoJCX07DQoJfSgpKTsNCg0KCXZhciBDb250cm9sbGVyID0gKGZ1bmN0aW9uKCl7DQoJCXZhciBhY3Rpdml0aWVzLA0KCQkJcmVwbGllcywNCgkJCXdpZGdldENvbnRleHQsDQoJCQlsb2FkaW5nID0gZmFsc2UsDQoJCQlkYXlEaXZpZGVycyA9IFtdLA0KCQkJZXh0cmFMb2FkQ291bnQgPSAwLA0KCQkJbWF4RXh0cmFMb2FkcyA9IDEwLA0KCQkJYWN0aXZpdHlNZXNzYWdlRWxlbWVudEZvciA9IGZ1bmN0aW9uKGVsZW1lbnQpIHsNCgkJCQlyZXR1cm4gJChlbGVtZW50KS5jbG9zZXN0KCdsaS5jb250ZW50LWl0ZW0uYWN0aXZpdHknKTsNCgkJCX0sDQoJCQljbGVhciA9IGZ1bmN0aW9uKCkgew0KCQkJCXdpZGdldENvbnRleHQuY29udGFpbmVyLmVtcHR5KCk7DQoJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLmNsb3Nlc3QoJy5sYXlvdXQtcmVnaW9uLmNvbnRlbnQnKS5jc3MoeydtaW4taGVpZ2h0JzonOTAwcHgnfSk7DQoJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLmNsb3Nlc3QoJy5sYXlvdXQnKS5maW5kKCcubGF5b3V0LXJlZ2lvbi1pbm5lci5yaWdodC1zaWRlYmFyJykuY3NzKHsnbWluLWhlaWdodCc6JzkwMHB4J30pOw0KCQkJfSwNCgkJCXdpbmRvd0lzU2Nyb2xsYWJsZSA9IGZ1bmN0aW9uKCkgew0KCQkJCXJldHVybiAkKGRvY3VtZW50KS5oZWlnaHQoKSA+ICQod2luZG93KS5oZWlnaHQoKTsNCgkJCX0sDQoJCQlsb2FkID0gZnVuY3Rpb24oc2hvd01vcmUsIGF1dG9SZWZyZXNoKSB7DQoJCQkJbG9hZGluZyA9IHRydWU7DQoJCQkJdmFyIGhhbmRsZVJlc3BvbnNlID0gZnVuY3Rpb24ocmVzcG9uc2UpIHsNCgkJCQkJdmFyIHJlc3BvbnNlID0gJC50cmltKHJlc3BvbnNlKTsNCgkJCQkJaWYgKHJlc3BvbnNlKSB7DQoJCQkJCQl2YXIgZmFsc2VDb250YWluZXIgPSAkKCc8ZGl2PjwvZGl2PicpOw0KCQkJCQkJcmVzcG9uc2UgPSAkKHJlc3BvbnNlKTsNCgkJCQkJCXJlc3BvbnNlLmFwcGVuZFRvKGZhbHNlQ29udGFpbmVyKTsNCg0KCQkJCQkJdmFyIGRhdGEgPSByZXNwb25zZS5jaGlsZHJlbignbGkuZGF0YScpLnJlbW92ZSgpOw0KCQkJCQkJaWYoIWF1dG9SZWZyZXNoKSB7DQoJCQkJCQkJaWYgKGRhdGEubGVuZ3RoID4gMCkgew0KCQkJCQkJCQl3aWRnZXRDb250ZXh0Lmxhc3RNZXNzYWdlRGF0ZSA9IGRhdGEuZGF0YSgnbGFzdG1lc3NhZ2VkYXRlJyk7DQoJCQkJCQkJCXdpZGdldENvbnRleHQuaGFzTW9yZURhdGEgPSB0cnVlOw0KCQkJCQkJCQl3aWRnZXRDb250ZXh0LnBhZ2VyLmZpbmQoJ2EnKS5zaG93KCk7DQoJCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQkJd2lkZ2V0Q29udGV4dC5oYXNNb3JlRGF0YSA9IGZhbHNlOw0KCQkJCQkJCQl3aWRnZXRDb250ZXh0LnBhZ2VyLmZpbmQoJ2EnKS5oaWRlKCk7DQoJCQkJCQkJfQ0KCQkJCQkJfQ0KDQoJCQkJCQl2YXIgaXRlbXMgPSByZXNwb25zZS5jaGlsZHJlbignbGknKTsNCg0KCQkJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLnRyaWdnZXIoJ3N0cmVhbUxvYWRlZCcsIHsNCgkJCQkJCQlhY3Rpdml0aWVzOiBpdGVtcw0KCQkJCQkJfSk7DQoNCgkJCQkJCXJlbmRlck1lc3NhZ2VzKGl0ZW1zLCBhdXRvUmVmcmVzaCk7DQoJCQkJCX0gZWxzZSB7DQoJCQkJCQl3aWRnZXRDb250ZXh0Lmhhc01vcmVEYXRhID0gZmFsc2U7DQoJCQkJCQl3aWRnZXRDb250ZXh0LnBhZ2VyLmZpbmQoJ2EnKS5oaWRlKCk7DQoJCQkJCQl3aWRnZXRDb250ZXh0LndyYXBwZXIudHJpZ2dlcignc3RyZWFtTG9hZEVycm9yJyk7DQoJCQkJCX0NCgkJCQkJbG9hZGluZyA9IGZhbHNlOw0KDQoJCQkJCS8vIGlmIHRoZSB3aW5kb3cgaXNuJ3QgeWV0IHNjcm9sbGFibGUgYW5kIHRoaXMgd2Fzbid0IGZvciBhIHNpbmdsZSBtZXNzYWdlLA0KCQkJCQkvLyB0cnkgbG9hZGluZyBtb3JlDQoJCQkJCWlmKCF3aW5kb3dJc1Njcm9sbGFibGUoKSAmJiAhd2lkZ2V0Q29udGV4dC5tZXNzYWdlSWQgJiYgd2lkZ2V0Q29udGV4dC5oYXNNb3JlRGF0YSAmJiBleHRyYUxvYWRDb3VudCA8IG1heEV4dHJhTG9hZHMpIHsNCgkJCQkJCWV4dHJhTG9hZENvdW50Kys7DQoJCQkJCQlsb2FkKHRydWUsIGZhbHNlKTsNCgkJCQkJfSBlbHNlIHsNCgkJCQkJCWV4dHJhTG9hZENvdW50ID0gMDsNCgkJCQkJfQ0KCQkJCX07DQoNCgkJCQlpZiAod2lkZ2V0Q29udGV4dC5tZXNzYWdlSWQpIHsNCgkJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLnRyaWdnZXIoJ3N0cmVhbUxvYWRpbmcnKTsNCg0KCQkJCQlhY3Rpdml0aWVzLmxpc3Qoew0KCQkJCQkJCWZpbHRlckluZGV4OiB3aWRnZXRDb250ZXh0LmZpbHRlckluZGV4LA0KCQkJCQkJCW1lc3NhZ2VJZDogd2lkZ2V0Q29udGV4dC5tZXNzYWdlSWQsDQoJCQkJCQkJdXNlcklkOiB3aWRnZXRDb250ZXh0LnVzZXJJZA0KCQkJCQkJfSwNCgkJCQkJCWhhbmRsZVJlc3BvbnNlLCAgICAgLy8gc3VjY2Vzcw0KCQkJCQkJZnVuY3Rpb24oKSB7ICAgICAgICAvLyBlcnJvcg0KCQkJCQkJCXdpZGdldENvbnRleHQud3JhcHBlci50cmlnZ2VyKCdzdHJlYW1Mb2FkRXJyb3InKTsNCgkJCQkJCQlsb2FkaW5nID0gZmFsc2U7DQoJCQkJCQl9KTsNCg0KCQkJCX0gZWxzZSB7DQoJCQkJCXdpZGdldENvbnRleHQud3JhcHBlci50cmlnZ2VyKCdzdHJlYW1Mb2FkaW5nJyk7DQoNCgkJCQkJYWN0aXZpdGllcy5saXN0KHsNCgkJCQkJCWZpbHRlckluZGV4OiB3aWRnZXRDb250ZXh0LmZpbHRlckluZGV4LA0KCQkJCQkJZmlsdGVyVHlwZTogd2lkZ2V0Q29udGV4dC5maWx0ZXJUeXBlLA0KCQkJCQkJZW5kRGF0ZTogc2hvd01vcmUgPyB3aWRnZXRDb250ZXh0Lmxhc3RNZXNzYWdlRGF0ZSA6ICcnLA0KCQkJCQkJcGFnZVNpemU6IHdpZGdldENvbnRleHQucGFnZVNpemUsDQoJCQkJCQl1c2VySWQ6IHdpZGdldENvbnRleHQudXNlcklkLA0KCQkJCQkJZ3JvdXA6IHdpZGdldENvbnRleHQuZ3JvdXBJZA0KCQkJCQl9LA0KCQkJCQloYW5kbGVSZXNwb25zZSwgICAgIC8vIHN1Y2Nlc3MNCgkJCQkJZnVuY3Rpb24oKSB7ICAgICAgICAvLyBlcnJvcg0KCQkJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLnRyaWdnZXIoJ3N0cmVhbUxvYWRFcnJvcicpOw0KCQkJCQkJbG9hZGluZyA9IGZhbHNlOw0KCQkJCQl9KTsNCgkJCQl9DQoJCQl9LA0KCQkJcmVuZGVyTWVzc2FnZXMgPSBmdW5jdGlvbihtZXNzYWdlcywgYXV0b1JlZnJlc2gpIHsNCgkJCQkvLyBmaWx0ZXIgbmV3bHkgZmV0Y2hlZCBtZXNzYWdlcyBpbnRvIG5ldyBtZXNzYWdlcyBhbmQgZXhpc3RpbmcNCgkJCQl2YXIgbmV3TWVzc2FnZXMgPSBbXSwNCgkJCQkJZXhpc3RpbmdNZXNzYWdlcyA9IFtdOw0KCQkJCSQuZWFjaChtZXNzYWdlcywgZnVuY3Rpb24oaSwgbWVzc2FnZSl7DQoJCQkJCXZhciBleGlzdGluZ01lc3NhZ2UgPSAkKCcjJyArIG1lc3NhZ2UuaWQpOw0KCQkJCQkoZXhpc3RpbmdNZXNzYWdlLmxlbmd0aCA9PT0gMCA/IG5ld01lc3NhZ2VzIDogZXhpc3RpbmdNZXNzYWdlcykucHVzaChtZXNzYWdlKTsNCgkJCQl9KTsNCg0KCQkJCXZhciBhcHBlbmQgPSBmdW5jdGlvbihtZXNzYWdlKSB7DQoJCQkJCXZhciBsYXRlc3REYXRlID0gbnVsbCwNCgkJCQkJCWxhdGVzdE1lc3NhZ2UgPSB3aWRnZXRDb250ZXh0LmNvbnRhaW5lci5maW5kKCdsaS5hY3Rpdml0eTpmaXJzdCcpOw0KCQkJCQlpZihsYXRlc3RNZXNzYWdlLmxlbmd0aCA+IDApIHsNCgkJCQkJCWxhdGVzdERhdGUgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ucGFyc2VEYXRlKGxhdGVzdE1lc3NhZ2UuZGF0YSgnYWN0aXZpdHlkYXRlJykpOw0KCQkJCQl9DQoJCQkJCXZhciBtZXNzYWdlRGF0ZSA9IG1lc3NhZ2UuZGF0YSgnYWN0aXZpdHlkYXRlJykgPyAkLnRlbGxpZ2VudC5ldm9sdXRpb24ucGFyc2VEYXRlKG1lc3NhZ2UuZGF0YSgnYWN0aXZpdHlkYXRlJykpIDogbmV3IERhdGUoKTsNCgkJCQkJaWYobWVzc2FnZURhdGUgPiBsYXRlc3REYXRlKSB7DQoJCQkJCQl3aWRnZXRDb250ZXh0LmNvbnRhaW5lci5wcmVwZW5kKG1lc3NhZ2UpOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJd2lkZ2V0Q29udGV4dC5jb250YWluZXIuYXBwZW5kKG1lc3NhZ2UpOw0KCQkJCQl9DQoJCQkJfQ0KDQoJCQkJaWYoYXV0b1JlZnJlc2gpIHsNCgkJCQkJLy8gcmV2ZXJzZSB0byBpbmplY3QgZnJvbSB0b3AgZG93bg0KCQkJCQluZXdNZXNzYWdlcy5yZXZlcnNlKCk7DQoJCQkJfQ0KDQoJCQkJLy8gYWRkIG5ldyBtZXNzYWdlcyB0byB1aSwgaW5pdGluZyBhZ2FpbnN0IGNsaWVudCBiZWhhdmlvcnMgYXMgd2VsbA0KCQkJCSQuZWFjaChuZXdNZXNzYWdlcywgZnVuY3Rpb24oaSwgbWVzc2FnZSkgew0KCQkJCQltZXNzYWdlID0gJChtZXNzYWdlKTsNCgkJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLnRyaWdnZXIoJ2FjdGl2aXR5QXBwZW5kaW5nJywgeyBhY3Rpdml0eTogbWVzc2FnZSwgYXV0bzogYXV0b1JlZnJlc2ggfSk7DQoJCQkJCWFwcGVuZChtZXNzYWdlKTsNCgkJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLnRyaWdnZXIoJ2FjdGl2aXR5QXBwZW5kZWQnLCB7IGFjdGl2aXR5OiBtZXNzYWdlLCBhdXRvOiBhdXRvUmVmcmVzaCAgfSk7DQoJCQkJfSk7DQoNCgkJCQkvLyBmb3IgZXhpc3RpbmcgbWVzc2FnZXMsIGFkZCBhbnkgbmV3IGNvbW1lbnRzIHRvIHRoZSB1aQ0KCQkJCSQuZWFjaChleGlzdGluZ01lc3NhZ2VzLCBmdW5jdGlvbihpLCBtZXNzYWdlKXsNCgkJCQkJLy8gcmVmcmVzaCBkYXRlcyBvZiBleGlzdGluZyBtZXNzYWdlcw0KCQkJCQlyZWZyZXNoQ29udGVudEl0ZW0oJCgnIycgKyBtZXNzYWdlLmlkKSwgJChtZXNzYWdlKSwgJ3Bvc3QtZGF0ZScpOw0KCQkJCQkvLyByZWZyZXNoIGNvbW1lbnQgY291bnRzIG9mIGV4aXN0aW5nIG1lc3NhZ2VzDQoJCQkJCXJlZnJlc2hDb250ZW50SXRlbSgkKCcjJyArIG1lc3NhZ2UuaWQpLCAkKG1lc3NhZ2UpLCAnY29sbGFwc2VkLWNvbW1lbnRzJyk7DQoJCQkJCS8vIHJlZnJlc2ggY29tbWVudHMNCgkJCQkJcmVuZGVyQ29tbWVudHMoJChtZXNzYWdlKSwgJChtZXNzYWdlKS5maW5kKCdsaS5jb250ZW50LWl0ZW0uY29tbWVudCcpLm5vdCgnLmNvbW1lbnQtZm9ybScpLCBhdXRvUmVmcmVzaCk7DQoJCQkJfSk7DQoNCgkJCQlyZW5kZXJEYXlEaXZpZGVycygpOw0KCQkJfSwNCgkJCXJlbmRlckRheURpdmlkZXJzID0gZnVuY3Rpb24oKSB7DQoJCQkJJC5lYWNoKGRheURpdmlkZXJzLCBmdW5jdGlvbihpLCBkaXZpZGVyKSB7DQoJCQkJCWRpdmlkZXIucmVtb3ZlKCk7DQoJCQkJfSk7DQoJCQkJZGF5RGl2aWRlcnMgPSBbXTsNCgkJCQl2YXIgY3VycmVudERhdGUgPSBudWxsOw0KCQkJCXZhciBhY3Rpdml0eUl0ZW1zID0gd2lkZ2V0Q29udGV4dC5jb250YWluZXIuZmluZCgnbGkuYWN0aXZpdHknKTsNCgkJCQkkLmVhY2goYWN0aXZpdHlJdGVtcywgZnVuY3Rpb24oaSwgYWN0aXZpdHkpew0KCQkJCQl2YXIgYWN0aXZpdHkgPSAkKGFjdGl2aXR5KSwNCgkJCQkJCWRhdGUgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ucGFyc2VEYXRlKGFjdGl2aXR5LmRhdGEoJ2FjdGl2aXR5ZGF0ZScpKTsNCg0KCQkJCQlpZihjdXJyZW50RGF0ZSA9PT0gbnVsbCB8fCAhKGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCkgPT09IGRhdGUuZ2V0RnVsbFllYXIoKSAmJiBjdXJyZW50RGF0ZS5nZXRNb250aCgpID09PSBkYXRlLmdldE1vbnRoKCkgJiYgY3VycmVudERhdGUuZ2V0RGF5KCkgPT09IGRhdGUuZ2V0RGF5KCkpKSB7DQoJCQkJCQljdXJyZW50RGF0ZSA9IGRhdGU7DQoJCQkJCQl2YXIgZGl2aWRlciA9ICQoJzxsaSBjbGFzcz0iYWN0aXZpdHktZGF0ZS1ncm91cGluZyI+PHNwYW4+PC9zcGFuPjwvbGk+JyksDQoJCQkJCQkJZGl2aWRlclNwYW4gPSBkaXZpZGVyLmZpbmQoJ3NwYW4nKTsNCgkJCQkJCWFjdGl2aXR5LmJlZm9yZShkaXZpZGVyKTsNCgkJCQkJCWJ1aWxkRGl2aWRlcihkYXRlLCBmdW5jdGlvbihmb3JtYXR0ZWREaXZpZGVyKSB7DQoJCQkJCQkJZGl2aWRlclNwYW4uaHRtbChmb3JtYXR0ZWREaXZpZGVyLnRleHQpOw0KCQkJCQkJCWlmIChmb3JtYXR0ZWREaXZpZGVyLnRvZGF5KSB7DQoJCQkJCQkJCWRpdmlkZXIuYWRkQ2xhc3MoJ3RvZGF5Jyk7DQoJCQkJCQkJfQ0KCQkJCQkJfSk7DQoJCQkJCQlkYXlEaXZpZGVycy5wdXNoKGRpdmlkZXIpOw0KCQkJCQl9DQoJCQkJfSk7DQoJCQl9LA0KCQkJYnVpbGREaXZpZGVyID0gZnVuY3Rpb24oZGF0ZSwgY29tcGxldGUpIHsNCgkJCQl2YXIgbm93ID0gbmV3IERhdGUoKTsNCgkJCQlpZiAoZGF0ZS5nZXRGdWxsWWVhcigpID09PSBub3cuZ2V0RnVsbFllYXIoKSAmJiBkYXRlLmdldE1vbnRoKCkgPT09IG5vdy5nZXRNb250aCgpICYmIGRhdGUuZ2V0RGF0ZSgpID09PSBub3cuZ2V0RGF0ZSgpKSB7DQoJCQkJCWNvbXBsZXRlKHsgdGV4dDogd2lkZ2V0Q29udGV4dC50b2RheVRleHQsIHRvZGF5OiB0cnVlIH0pOw0KCQkJCX0gZWxzZSB7DQoJCQkJCS8vIGZsb29yIHRoZSBkYXRlIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIGRheSB0byBtYXhpbWltemUgY2FjaGUgaGl0cyBmb3IgZm9ybWF0dGVkIGRhdGVzDQoJCQkJCXZhciBkYXlCYXNlZERhdGUgPSBuZXcgRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIGRhdGUuZ2V0TW9udGgoKSwgZGF0ZS5nZXREYXRlKCkpOw0KCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubGFuZ3VhZ2UuZm9ybWF0RGF0ZShkYXlCYXNlZERhdGUsIGZ1bmN0aW9uKGZvcm1hdHRlZCkgew0KCQkJCQkJY29tcGxldGUoeyB0ZXh0OiBmb3JtYXR0ZWQsIHRvZGF5OiBmYWxzZSB9KTsNCgkJCQkJfSk7DQoJCQkJfQ0KCQkJfSwNCgkJCWNvbnRhaW5zID0gZnVuY3Rpb24oYXJyYXksIGZuKSB7DQoJCQkJdmFyIGNvbnRhaW5zID0gZmFsc2U7DQoJCQkJJC5lYWNoKGFycmF5LCBmdW5jdGlvbihpLCB2YWwpew0KCQkJCQlpZihmbih2YWwpKSB7DQoJCQkJCQljb250YWlucyA9IHRydWU7DQoJCQkJCQlyZXR1cm4gZmFsc2U7DQoJCQkJCX0NCgkJCQl9KTsNCgkJCX0sDQoJCQlyZWZyZXNoQ29udGVudEl0ZW0gPSBmdW5jdGlvbihleGlzdGluZ0VsZW1lbnQsIHJlZnJlc2hlZEVsZW1lbnQsIGNsYXNzTmFtZSkgew0KCQkJCXZhciBleGlzdGluZyA9IGV4aXN0aW5nRWxlbWVudC5maXJzdCgpLmZpbmQoJy4nICsgY2xhc3NOYW1lKTsNCgkJCQl2YXIgcmVmcmVzaGVkID0gcmVmcmVzaGVkRWxlbWVudC5maXJzdCgpLmZpbmQoJy4nICsgY2xhc3NOYW1lKTsNCgkJCQlpZihleGlzdGluZy5sZW5ndGggPiAwICYmIHJlZnJlc2hlZC5sZW5ndGggPiAwKSB7DQoJCQkJCWV4aXN0aW5nLmh0bWwocmVmcmVzaGVkLmh0bWwoKSk7DQoJCQkJfQ0KCQkJfSwNCgkJCXJlZnJlc2hDb21tZW50cyA9IGZ1bmN0aW9uKGFjdGl2aXR5RWxlbWVudCwgYXV0b1JlZnJlc2gpIHsNCgkJCQkvLyB3aGVuIGNvbW1lbnRpbmcgaXMgc3VjY2Vzc2Z1bCwgZ2V0IHRoZSBuZXcgcmVuZGVyZWQgY29tbWVudCBsaXN0IG9ubHkNCgkJCQkvLyBmb3IgdGhpcyBhY3Rpdml0eSBpdGVtDQoJCQkJYWN0aXZpdGllcy5saXN0KHsNCgkJCQkJCW1lc3NhZ2VJZDogYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2FjdGl2aXR5aWQnKSwNCgkJCQkJCXVzZXJJZDogYWN0aXZpdHlFbGVtZW50LmRhdGEoJ2F1dGhvcmlkJyksDQoJCQkJCQllbmREYXRlOiBhY3Rpdml0eUVsZW1lbnQuZGF0YSgnYWN0aXZpdHlkYXRlJykNCgkJCQkJfSwNCgkJCQkJZnVuY3Rpb24ocmVzcG9uc2UpIHsgICAgICAgIC8vIHN1Y2Nlc3MNCgkJCQkJCXZhciByZXNwb25zZSA9ICQudHJpbShyZXNwb25zZSk7DQoJCQkJCQlpZiAocmVzcG9uc2UpIHsNCgkJCQkJCQlyZXNwb25zZSA9ICQocmVzcG9uc2UpOw0KCQkJCQkJCXJlbmRlckNvbW1lbnRzKHJlc3BvbnNlLmZpbmQoJ2xpLmNvbnRlbnQtaXRlbS5hY3Rpdml0eScpLA0KCQkJCQkJCQlyZXNwb25zZS5maW5kKCdsaS5jb250ZW50LWl0ZW0uY29tbWVudCcpLm5vdCgnLmNvbW1lbnQtZm9ybScpKTsNCgkJCQkJCX0NCgkJCQkJfSwNCgkJCQkJZnVuY3Rpb24oKSB7ICAgICAgICAvLyBlcnJvcg0KCQkJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLnRyaWdnZXIoJ3N0cmVhbUxvYWRFcnJvcicpOw0KCQkJCQl9KTsNCgkJCX0sDQoJCQlyZW5kZXJDb21tZW50cyA9IGZ1bmN0aW9uKG1lc3NhZ2VJdGVtLCBuZXdDb21tZW50SXRlbXMsIGF1dG9SZWZyZXNoKSB7DQoJCQkJdmFyIGV4aXN0aW5nTWVzc2FnZSA9ICQoJyMnICsgbWVzc2FnZUl0ZW0uYXR0cignaWQnKSk7DQoJCQkJaWYoZXhpc3RpbmdNZXNzYWdlKSB7DQoJCQkJCXZhciByZXBseUZvcm0gPSBleGlzdGluZ01lc3NhZ2UuZmluZCgnbGkuY29udGVudC1pdGVtLmNvbW1lbnQuY29tbWVudC1mb3JtJyksDQoJCQkJCQlyZXBseUxpc3QgPSBleGlzdGluZ01lc3NhZ2UuZmluZCgndWwuY29udGVudC1saXN0LmNvbW1lbnRzJyksDQoJCQkJCQlleGlzdGluZ0NvbW1lbnRzID0gZXhpc3RpbmdNZXNzYWdlLmZpbmQoJ2xpLmNvbnRlbnQtaXRlbS5jb21tZW50Jykubm90KCcuY29tbWVudC1mb3JtJyksDQoJCQkJCQlrZWVwQ29tbWVudHMgPSBbXSwNCgkJCQkJCWFwcGVuZFJlcGx5ID0gZnVuY3Rpb24ocmVwbHkpIHsNCgkJCQkJCQl2YXIgcmVwbHlEYXRlID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnBhcnNlRGF0ZShyZXBseS5kYXRhKCdjb21tZW50ZGF0ZScpKSwNCgkJCQkJCQkJbGF0ZXN0UmVwbHkgPSByZXBseUxpc3QuZmluZCgnbGkuY29tbWVudDpub3QobGkuY29tbWVudC1mb3JtKTpsYXN0Jyk7DQoJCQkJCQkJaWYobGF0ZXN0UmVwbHkubGVuZ3RoID4gMCAmJiByZXBseURhdGUgPiAkLnRlbGxpZ2VudC5ldm9sdXRpb24ucGFyc2VEYXRlKGxhdGVzdFJlcGx5LmRhdGEoJ2NvbW1lbnRkYXRlJykpKSB7DQoJCQkJCQkJCWxhdGVzdFJlcGx5LmFmdGVyKHJlcGx5KTsNCgkJCQkJCQl9IGVsc2UgaWYobGF0ZXN0UmVwbHkubGVuZ3RoID4gMCkgew0KCQkJCQkJCQlleGlzdGluZ0NvbW1lbnRzLmJlZm9yZShyZXBseSk7DQoJCQkJCQkJfSBlbHNlIGlmKHJlcGx5Rm9ybS5sZW5ndGggPiAwKSB7DQoJCQkJCQkJCXJlcGx5Rm9ybS5iZWZvcmUocmVwbHkpOw0KCQkJCQkJCX0gZWxzZSB7DQoJCQkJCQkJCXJlcGx5TGlzdC5hcHBlbmQocmVwbHkpOw0KCQkJCQkJCX0NCgkJCQkJCX07DQoNCgkJCQkJLy8gYWRkIG5ldyBjb21tZW50cywgdHJhY2sgY29tbWVudHMgdGhhdCBzaG91aWxkbid0IGJlIHJlbW92ZWQNCgkJCQkJJC5lYWNoKG5ld0NvbW1lbnRJdGVtcywgZnVuY3Rpb24oaSwgbmV3Q29tbWVudCl7DQoJCQkJCQluZXdDb21tZW50ID0gJChuZXdDb21tZW50KTsNCgkJCQkJCW5ld0NvbW1lbnQuaGlkZSgpOw0KDQoJCQkJCQl2YXIgbmV3Q29tbWVudElkID0gbmV3Q29tbWVudC5kYXRhKCdjb21tZW50aWQnKTsNCgkJCQkJCXZhciBleGlzdGluZ0NvbW1lbnQgPSBleGlzdGluZ0NvbW1lbnRzLmZpbHRlcignW2RhdGEtY29tbWVudGlkPSInK25ld0NvbW1lbnRJZCsnIl0nKS5maXJzdCgpOw0KDQoJCQkJCQlpZiAoZXhpc3RpbmdDb21tZW50Lmxlbmd0aCA9PT0gMSkgew0KCQkJCQkJCWtlZXBDb21tZW50c1tuZXdDb21tZW50SWRdID0gbmV3Q29tbWVudDsNCgkJCQkJCX0gZWxzZSB7DQoJCQkJCQkJYXBwZW5kUmVwbHkobmV3Q29tbWVudCk7DQoJCQkJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLnRyaWdnZXIoJ2NvbW1lbnRBZGRlZCcsIHsgYWN0aXZpdHlFbGVtZW50OiBleGlzdGluZ01lc3NhZ2UsIGNvbW1lbnQ6IG5ld0NvbW1lbnQsIGF1dG86IGF1dG9SZWZyZXNoIH0pOw0KCQkJCQkJfQ0KCQkJCQl9KTsNCg0KCQkJCQkvLyByZW1vdmUgZGVsZXRlZCBjb21tZW50cyBvciB1cGRhdGUgdGltZSBvZiBub24tZGVsZXRlZCBleGlzdGluZw0KCQkJCQkkLmVhY2goZXhpc3RpbmdDb21tZW50cywgZnVuY3Rpb24oaSwgY29tbSkgew0KCQkJCQkJY29tbSA9ICQoY29tbSk7DQoJCQkJCQl2YXIga2VwdENvbW1lbnQgPSBrZWVwQ29tbWVudHNbY29tbS5kYXRhKCdjb21tZW50aWQnKV07DQoJCQkJCQlpZigha2VwdENvbW1lbnQpIHsNCgkJCQkJCQl3aWRnZXRDb250ZXh0LndyYXBwZXIudHJpZ2dlcignY29tbWVudERlbGV0ZWQnLCB7IGNvbW1lbnQ6IGNvbW0gfSk7DQoJCQkJCQl9IGVsc2Ugew0KCQkJCQkJCXJlZnJlc2hDb250ZW50SXRlbShjb21tLCBrZXB0Q29tbWVudCwgJ3JlcGx5LWRhdGUnKTsNCgkJCQkJCX0NCgkJCQkJfSk7DQoJCQkJfQ0KCQkJfSwNCgkJCWRlYm91bmNlID0gZnVuY3Rpb24oZm4sIG1zKSB7DQoJCQkJdmFyIGNhbGxlZEluSW50ZXJ2YWwgPSB0cnVlOw0KCQkJCXNldEludGVydmFsKGZ1bmN0aW9uKCl7DQoJCQkJCWNhbGxlZEluSW50ZXJ2YWwgPSBmYWxzZTsNCgkJCQl9LCBtcyk7DQoJCQkJcmV0dXJuIGZ1bmN0aW9uKCl7DQoJCQkJCWlmKCFjYWxsZWRJbkludGVydmFsKSB7DQoJCQkJCQljYWxsZWRJbkludGVydmFsID0gdHJ1ZTsNCgkJCQkJCWZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykNCgkJCQkJfQ0KCQkJCX07DQoJCQl9LA0KCQkJYmluZEV2ZW50cyA9IGZ1bmN0aW9uKCkgew0KCQkJCS8vIGxvYWQgbWVzc2FnZXMgb24gYnJvd3NlciBmb2N1cywgYm91bmNlZCB0byBhIG1heCBvZiAxIGF1dG8tcmVmcmVzaCBwZXIgbWludXRlDQoJCQkJJCh3aW5kb3cpLmJpbmQoJ2ZvY3VzJywgZGVib3VuY2UoZnVuY3Rpb24oKXsNCgkJCQkJbG9hZChmYWxzZSwgdHJ1ZSk7DQoJCQkJfSwgMSAqIDYwICogMTAwMCkpOw0KDQoJCQkJdmFyIHJlZnJlc2ggPSBmdW5jdGlvbigpIHsgbG9hZChmYWxzZSwgZmFsc2UpOyB9Ow0KCQkJCS8vIGhhbmRsZSBleHBsaWNpdCB1cGRhdGVzIHRyaWdnZXJlZCBmcm9tIG90aGVyIHdpZGdldHMNCgkJCQkkKGRvY3VtZW50KS5iaW5kKCd0ZWxsaWdlbnRfbWVzc2FnaW5nX2FjdGl2aXR5bWVzc2FnZXVwZGF0ZWQnLCByZWZyZXNoKTsNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZSgnYWN0aXZpdHkuY29tbWVudGFkZGVkJywgcmVmcmVzaCk7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ2FjdGl2aXR5LmNvbW1lbnRyZW1vdmVkJywgcmVmcmVzaCk7DQoNCgkJCQkvLyBhdXRvbWF0aWNhbGx5IGxvYWQgbW9yZSBvbmNlIHNjcm9sbGVkIHRvIHRoZSBlbmQgb2YgdGhlIHBhZ2UNCgkJCQlpZih3aWRnZXRDb250ZXh0LmVuZGxlc3NTY3JvbGwpIHsNCgkJCQkJJChkb2N1bWVudCkuYmluZCgnc2Nyb2xsZW5kJywgZnVuY3Rpb24oKSB7DQoJCQkJCQlpZighbG9hZGluZyAmJiB3aWRnZXRDb250ZXh0Lmhhc01vcmVEYXRhKSB7DQoJCQkJCQkJbG9hZCh0cnVlLCBmYWxzZSk7DQoJCQkJCQl9DQoJCQkJCX0pOw0KCQkJCX0NCg0KCQkJCS8vIGZpbHRlciB0YmFzDQoJCQkJaWYod2lkZ2V0Q29udGV4dC50YWJzLmZpbmQoJ2EnKS5sZW5ndGggPiAxKSB7DQoJCQkJCXdpZGdldENvbnRleHQudGFicy5maW5kKCdzcGFuLmZpbHRlci1vcHRpb246Zmlyc3QnKS5hZGRDbGFzcygnc2VsZWN0ZWQnKTsNCgkJCQkJd2lkZ2V0Q29udGV4dC50YWJzDQoJCQkJCQkuc2hvdygpDQoJCQkJCQkuZGVsZWdhdGUoJ2EnLCAnY2xpY2snLCBmdW5jdGlvbihlKXsNCgkJCQkJCQllLnByZXZlbnREZWZhdWx0KCk7DQoJCQkJCQkJd2lkZ2V0Q29udGV4dC5maWx0ZXJJbmRleCA9ICQoZS50YXJnZXQpLmRhdGEoJ2ZpbHRlcmluZGV4Jyk7DQoJCQkJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLnRyaWdnZXIoJ2ZpbHRlclNlbGVjdGVkJywgeyBmaWx0ZXJFbGVtZW50OiAkKGUudGFyZ2V0KSB9KTsNCgkJCQkJCQljbGVhcigpOw0KCQkJCQkJCWxvYWQoKTsNCgkJCQkJCX0pOw0KCQkJCX0NCg0KCQkJCS8vIGFjdGl2aXR5IHN0b3J5IGRlbGV0aW5nDQoJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLmRlbGVnYXRlKCcuZnVsbC1wb3N0LmFjdGl2aXR5JywnZXZvbHV0aW9uTW9kZXJhdGVMaW5rQ2xpY2tlZCcsIGZ1bmN0aW9uKGUsIGxpbmspew0KCQkJCQllLnByZXZlbnREZWZhdWx0KCk7DQoJCQkJCWlmKGNvbmZpcm0od2lkZ2V0Q29udGV4dC5kZWxldGVBY3Rpdml0eU1lc3NhZ2UpKSB7DQoJCQkJCQl2YXIgYWN0aXZpdHlFbGVtZW50ID0gJChhY3Rpdml0eU1lc3NhZ2VFbGVtZW50Rm9yKHRoaXMpKTsNCgkJCQkJCXdpZGdldENvbnRleHQud3JhcHBlci50cmlnZ2VyKCdhY3Rpdml0eURlbGV0aW5nJywgeyBhY3Rpdml0eUVsZW1lbnQ6IGFjdGl2aXR5RWxlbWVudCB9KTsNCgkJCQkJCWFjdGl2aXRpZXMuZGVsKGFjdGl2aXR5RWxlbWVudC5kYXRhKCdhY3Rpdml0eWlkJyksDQoJCQkJCQkJZnVuY3Rpb24oKXsNCgkJCQkJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLnRyaWdnZXIoJ2FjdGl2aXR5RGVsZXRlZCcsIHsgYWN0aXZpdHlFbGVtZW50OiBhY3Rpdml0eUVsZW1lbnQgfSk7DQoJCQkJCQkJfSwNCgkJCQkJCQlmdW5jdGlvbigpew0KCQkJCQkJCQl3aWRnZXRDb250ZXh0LndyYXBwZXIudHJpZ2dlcignYWN0aXZpdHlEZWxldGVFcnJvcicsIHsgYWN0aXZpdHlFbGVtZW50OiBhY3Rpdml0eUVsZW1lbnQgfSk7DQoJCQkJCQkJfSk7DQoJCQkJCX0NCgkJCQkJcmV0dXJuIGZhbHNlOw0KCQkJCX0pOw0KDQoJCQkJLy8gcHJpdmF0ZSBjb252ZXJzYXRpb24gc3RhcnRpbmcNCgkJCQl3aWRnZXRDb250ZXh0LndyYXBwZXIuZGVsZWdhdGUoJy5wb3N0LWFjdGlvbnMuYWN0aXZpdHkgYS5pbnRlcm5hbC1saW5rLnN0YXJ0LWNvbnZlcnNhdGlvbicsICdjbGljaycsIGZ1bmN0aW9uKGUpIHsNCgkJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KCQkJCQl2YXIgY29udmVyc2F0aW9uVXJsID0gJChlLnRhcmdldCkuZGF0YSgnY29udmVyc2F0aW9udXJsJyk7DQoJCQkJCSQuZ2xvd01vZGFsKGNvbnZlcnNhdGlvblVybCwgeyB3aWR0aDogNTUwLCBoZWlnaHQ6IDM2MCB9KTsNCgkJCQl9KTsNCgkJCQkvLyBjb21tZW50IGZvcm0gcmV2ZWFsaW5nDQoJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLmRlbGVnYXRlKCcucG9zdC1hY3Rpb25zLmFjdGl2aXR5IGEuaW50ZXJuYWwtbGluay5jb21tZW50JywgJ2NsaWNrJywgZnVuY3Rpb24oZSkgew0KCQkJCQllLnByZXZlbnREZWZhdWx0KCk7DQoJCQkJCXdpZGdldENvbnRleHQud3JhcHBlci50cmlnZ2VyKCdjb21tZW50QmVnaW4nLCB7IGFjdGl2aXR5OiBhY3Rpdml0eU1lc3NhZ2VFbGVtZW50Rm9yKGUudGFyZ2V0KSB9KTsNCgkJCQl9KTsNCgkJCQkvLyBjb21tZW50IGZvcm0gZm9jdXNpbmcvdW5mb2N1c2luZw0KCQkJCXdpZGdldENvbnRleHQud3JhcHBlci5kZWxlZ2F0ZSgnLmNvbW1lbnQtZm9ybSB0ZXh0YXJlYScsICdmb2N1cycsIGZ1bmN0aW9uKGUpIHsNCgkJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLnRyaWdnZXIoJ2NvbW1lbnRFZGl0JywgeyBhY3Rpdml0eTogYWN0aXZpdHlNZXNzYWdlRWxlbWVudEZvcihlLnRhcmdldCkgfSk7DQoJCQkJCXZhciB0YSA9ICQoZS50YXJnZXQpOw0KCQkJCQkvLyB3aGVuIGEgdGV4dCBhcmVhIGlzIGZvY3VzZWQsIHNldCB1cCBpdHMgY29tcG9zZXIgYW5kIHNldCB1cCBoYW5kbGVycyBmb3Igc3VibWl0dGluZyBpdHMgcmVzdWx0cw0KCQkJCQlpZighdGEuZGF0YSgnY29tcG9zZXJfaW5pdGVkJykpIHsNCgkJCQkJCXRhLmRhdGEoJ2NvbXBvc2VyX2luaXRlZCcsIHRydWUpOw0KCQkJCQkJdGEuZXZvbHV0aW9uQ29tcG9zZXIoew0KCQkJCQkJCXBsdWdpbnM6IFsnbWVudGlvbnMnLCdoYXNodGFncyddDQoJCQkJCQl9KTsNCgkJCQkJCXRhLmV2b2x1dGlvbkNvbXBvc2VyKCdvbmtleWRvd24nLCBmdW5jdGlvbihlKXsNCgkJCQkJCQlpZiAoZS53aGljaCA9PT0gMTMpDQoJCQkJCQkJew0KCQkJCQkJCQl2YXIgYWN0aXZpdHlFbGVtZW50ID0gJChhY3Rpdml0eU1lc3NhZ2VFbGVtZW50Rm9yKGUudGFyZ2V0KSksDQoJCQkJCQkJCQlib2R5ID0gJChlLnRhcmdldCkuZXZvbHV0aW9uQ29tcG9zZXIoJ3ZhbCcpLA0KCQkJCQkJCQkJcmVwbHlEYXRhID0gew0KCQkJCQkJCQkJCWFjdGl2aXR5RWxlbWVudDogYWN0aXZpdHlFbGVtZW50LA0KCQkJCQkJCQkJCWJvZHk6IGJvZHkNCgkJCQkJCQkJCX07DQoJCQkJCQkJCWlmKCQudHJpbShib2R5KS5sZW5ndGggPiAwKSB7DQoJCQkJCQkJCQl3aWRnZXRDb250ZXh0LndyYXBwZXIudHJpZ2dlcignY29tbWVudEFkZGluZycsIHJlcGx5RGF0YSk7DQoJCQkJCQkJCQlyZXBsaWVzLmFkZChhY3Rpdml0eUVsZW1lbnQsIGJvZHksDQoJCQkJCQkJCQkJZnVuY3Rpb24ocmVzcG9uc2UpIHsgICAgLy8gc3VjY2Vzcw0KCQkJCQkJCQkJCQlpZighcmVzcG9uc2UuQ29tbWVudC5Jc0FwcHJvdmVkKSB7DQoJCQkJCQkJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubm90aWZpY2F0aW9ucy5zaG93KHdpZGdldENvbnRleHQuY29tbWVudE1vZGVyYXRlZE1lc3NhYWdlLCB7IHR5cGU6ICdzdWNjZXNzJywgZHVyYXRpb246IDEwMDAwIH0pOw0KCQkJCQkJCQkJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLnRyaWdnZXIoJ2NvbW1lbnRBZGRFcnJvcicsIHJlcGx5RGF0YSk7DQoJCQkJCQkJCQkJCX0gZWxzZSB7CQkJCQkJCQkJCQkNCgkJCQkJCQkJCQkJCXJlZnJlc2hDb21tZW50cyhhY3Rpdml0eUVsZW1lbnQpOw0KCQkJCQkJCQkJCQl9DQoJCQkJCQkJCQkJfSwNCgkJCQkJCQkJCQlmdW5jdGlvbihyZXNwb25zZSkgeyAgICAvLyBlcnJvcg0KCQkJCQkJCQkJCQl3aWRnZXRDb250ZXh0LndyYXBwZXIudHJpZ2dlcignY29tbWVudEFkZEVycm9yJywgcmVwbHlEYXRhKTsNCgkJCQkJCQkJCQl9KTsNCgkJCQkJCQkJfQ0KCQkJCQkJCQlyZXR1cm4gZmFsc2U7DQoJCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQkJcmV0dXJuIHRydWU7DQoJCQkJCQkJfQ0KCQkJCQkJfSk7DQoJCQkJCX0NCgkJCQl9KTsNCgkJCQl3aWRnZXRDb250ZXh0LndyYXBwZXIuZGVsZWdhdGUoJy5jb21tZW50LWZvcm0gdGV4dGFyZWEnLCAnYmx1cicsIGZ1bmN0aW9uKGUpIHsNCgkJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLnRyaWdnZXIoJ2NvbW1lbnRDYW5jZWwnLCB7IGFjdGl2aXR5OiBhY3Rpdml0eU1lc3NhZ2VFbGVtZW50Rm9yKGUudGFyZ2V0KSB9KTsNCgkJCQl9KTsNCg0KCQkJCS8vIGNvbW1lbnQgZGVsZXRpbmcNCgkJCQkvLyBjb21tZW50IGRlbGV0aW5nDQoJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLmRlbGVnYXRlKCcuZnVsbC1wb3N0LmNvbW1lbnQnLCdldm9sdXRpb25Nb2RlcmF0ZUxpbmtDbGlja2VkJywgZnVuY3Rpb24oZSwgbGluayl7DQoJCQkJCWUucHJldmVudERlZmF1bHQoKTsNCgkJCQkJaWYoY29uZmlybSh3aWRnZXRDb250ZXh0LmRlbGV0ZUNvbW1lbnRNZXNzYWdlKSkgew0KCQkJCQkJdmFyIGFjdGl2aXR5RWxlbWVudCA9ICQoYWN0aXZpdHlNZXNzYWdlRWxlbWVudEZvcih0aGlzKSksDQoJCQkJCQkJY29tbWVudEVsZW1lbnQgPSAkKHRoaXMpLmNsb3Nlc3QoJ2xpLmNvbnRlbnQtaXRlbS5jb21tZW50JyksDQoJCQkJCQkJZGF0YSA9IHsNCgkJCQkJCQkJYWN0aXZpdHlFbGVtZW50OiBhY3Rpdml0eUVsZW1lbnQsDQoJCQkJCQkJCWNvbW1lbnQ6IGNvbW1lbnRFbGVtZW50DQoJCQkJCQkJfTsNCgkJCQkJCXdpZGdldENvbnRleHQud3JhcHBlci50cmlnZ2VyKCdhY3Rpdml0eURlbGV0aW5nJywgZGF0YSk7DQoJCQkJCQlyZXBsaWVzLmRlbChhY3Rpdml0eUVsZW1lbnQsIGNvbW1lbnRFbGVtZW50LA0KCQkJCQkJCWZ1bmN0aW9uKCl7DQoJCQkJCQkJCS8vd2lkZ2V0Q29udGV4dC53cmFwcGVyLnRyaWdnZXIoJ2NvbW1lbnREZWxldGVkJywgZGF0YSk7DQoJCQkJCQkJCXJlZnJlc2hDb21tZW50cyhhY3Rpdml0eUVsZW1lbnQpOw0KCQkJCQkJCX0sDQoJCQkJCQkJZnVuY3Rpb24oKXsNCgkJCQkJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLnRyaWdnZXIoJ2FjdGl2aXR5RGVsZXRlRXJyb3InLCBkYXRhKTsNCgkJCQkJCQl9KTsNCgkJCQkJfQ0KCQkJCQlyZXR1cm4gZmFsc2U7DQoJCQkJfSk7DQoJCQkJLy8gY29sbGFwc2VkIGNvbW1lbnQgZXhwYW5kaW5nDQoJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLmRlbGVnYXRlKCcuY29tbWVudHMgLmNvbnRlbnQtaXRlbS5jb2xsYXBzZWQtY29tbWVudHMgYScsICdjbGljaycsIGZ1bmN0aW9uKGUpIHsNCgkJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KCQkJCQl3aWRnZXRDb250ZXh0LndyYXBwZXIudHJpZ2dlcignY29tbWVudHNTaG93SGlkZGVuJywgeyBhY3Rpdml0eUVsZW1lbnQ6ICQoYWN0aXZpdHlNZXNzYWdlRWxlbWVudEZvcihlLnRhcmdldCkpIH0pOw0KCQkJCX0pOw0KCQkJCXdpZGdldENvbnRleHQud3JhcHBlci5kZWxlZ2F0ZSgnLmNvbW1lbnRzIC5jb250ZW50LWl0ZW0uYWN0aW9uLmNvbGxhcHNlIGEnLCAnY2xpY2snLCBmdW5jdGlvbihlKSB7DQoJCQkJCWUucHJldmVudERlZmF1bHQoKTsNCgkJCQkJcmVwbGllcy5saXN0KHsNCgkJCQkJCWNvbW1lbnRQYWdlSW5kZXg6ICQoZS50YXJnZXQpLmRhdGEoJ3BhZ2VpbmRleCcpLA0KCQkJCQkJc3RvcnlJZDogJChlLnRhcmdldCkuZGF0YSgnc3RvcnlpZCcpDQoJCQkJCX0sIGZ1bmN0aW9uKHJlc3BvbnNlKXsNCgkJCQkJCXdpZGdldENvbnRleHQud3JhcHBlci50cmlnZ2VyKCdjb21tZW50c01vcmVMb2FkZWQnLCB7DQoJCQkJCQkJY29tbWVudHM6ICQocmVzcG9uc2UpLA0KCQkJCQkJCWFjdGl2aXR5RWxlbWVudDogJChhY3Rpdml0eU1lc3NhZ2VFbGVtZW50Rm9yKGUudGFyZ2V0KSkNCgkJCQkJCX0pOw0KCQkJCQl9LCBmdW5jdGlvbigpew0KCQkJCQkJd2lkZ2V0Q29udGV4dC53cmFwcGVyLnRyaWdnZXIoJ2NvbW1lbnRzTW9yZUVycm9yJyk7DQoJCQkJCX0pOw0KCQkJCX0pOw0KCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tZXNzYWdpbmcuc3Vic2NyaWJlKCd1aS5saWtlJywgZnVuY3Rpb24oZGF0YSl7DQoJCQkJCXZhciBsaWtlZEFjdGl2aXR5RWxlbWVudCA9IHdpZGdldENvbnRleHQud3JhcHBlci5maW5kKCdsaVtkYXRhLWNvbnRlbnRpZD0iJyArIGRhdGEuY29udGVudElkICsgJyJdW2RhdGEtdHlwZWlkPSInICsgZGF0YS50eXBlSWQgKyAnIl0nKTsNCgkJCQkJaWYoZGF0YS5jb3VudCA+IDApIHsNCgkJCQkJCXdpZGdldENvbnRleHQud3JhcHBlci50cmlnZ2VyKCdsaWtlQWRkZWQnLCB7IGFjdGl2aXR5RWxlbWVudDogbGlrZWRBY3Rpdml0eUVsZW1lbnQgfSk7DQoJCQkJCX0gZWxzZSB7DQoJCQkJCQl3aWRnZXRDb250ZXh0LndyYXBwZXIudHJpZ2dlcignbGlrZXNSZW1vdmVkJywgeyBhY3Rpdml0eUVsZW1lbnQ6IGxpa2VkQWN0aXZpdHlFbGVtZW50IH0pOw0KCQkJCQl9DQoJCQkJfSk7DQoJCQl9Ow0KCQlyZXR1cm4gew0KCQkJaW5pdDogZnVuY3Rpb24oY29udGV4dCwgYWN0aXZpdHlTZXJ2aWNlLCByZXBseVNlcnZpY2UpIHsNCgkJCQl3aWRnZXRDb250ZXh0ID0gY29udGV4dDsNCgkJCQlhY3Rpdml0aWVzID0gYWN0aXZpdHlTZXJ2aWNlOw0KCQkJCXJlcGxpZXMgPSByZXBseVNlcnZpY2U7DQoNCgkJCQljb250ZXh0LnBhZ2VyLmZpbmQoJ2EnKS5iaW5kKCdjbGljaycsIGZ1bmN0aW9uKGUpew0KCQkJCQllLnByZXZlbnREZWZhdWx0KCk7DQoJCQkJCWxvYWQodHJ1ZSkNCgkJCQl9KTsNCg0KCQkJCWJpbmRFdmVudHMoKTsNCgkJCQlsb2FkKCk7DQoJCQl9LA0KCQkJb246IGZ1bmN0aW9uKGNvbnRleHQsIGV2ZW50SGFuZGxlcnMpIHsNCgkJCQljb250ZXh0LndyYXBwZXIuYmluZChldmVudEhhbmRsZXJzKTsNCgkJCX0sDQoJCQlyZW5kZXJEYXlEaXZpZGVyczogcmVuZGVyRGF5RGl2aWRlcnMNCgkJfTsNCgl9KCkpOw0KDQoJdmFyIFZpZXcgPSAoZnVuY3Rpb24oKXsNCgkJdmFyIGNhcHR1cmVVaUVsZW1lbnRzID0gZnVuY3Rpb24oY29udGV4dCkgew0KCQkJCS8vIHNlbGVjdCBlbGVtZW50cw0KCQkJCSQuZWFjaChbJ3RhYnMnLCd3cmFwcGVyJywnbG9hZGVyJywncGFnZXInLCdjb250YWluZXInXSwgZnVuY3Rpb24oaSwgdmFsKSB7DQoJCQkJCWNvbnRleHRbdmFsXSA9ICQoY29udGV4dFt2YWxdKTsNCgkJCQl9KTsNCgkJCX0sDQoJCQloYW5kbGVFdmVudHMgPSBmdW5jdGlvbihjb250ZXh0LCBjb250cm9sbGVyKSB7DQoJCQkJY29udHJvbGxlci5vbihjb250ZXh0LCB7DQoJCQkJCWFjdGl2aXR5RGVsZXRpbmc6IGZ1bmN0aW9uKGUsIGRhdGEpIHsgfSwNCgkJCQkJYWN0aXZpdHlEZWxldGVkOiBmdW5jdGlvbihlLCBkYXRhKSB7DQoJCQkJCQlkYXRhLmFjdGl2aXR5RWxlbWVudC5mYWRlT3V0KDI1MCwgZnVuY3Rpb24oKXsNCgkJCQkJCQlkYXRhLmFjdGl2aXR5RWxlbWVudC5yZW1vdmUoKTsNCgkJCQkJCQlDb250cm9sbGVyLnJlbmRlckRheURpdmlkZXJzKCk7DQoJCQkJCQl9KTsNCgkJCQkJfSwNCgkJCQkJYWN0aXZpdHlEZWxldGVFcnJvcjogZnVuY3Rpb24oZSwgZGF0YSkgeyB9LA0KCQkJCQlzdHJlYW1Mb2FkaW5nOiBmdW5jdGlvbihlLCBkYXRhKSB7DQoJCQkJCQljb250ZXh0LmxvYWRlci5zaG93KCk7DQoJCQkJCX0sDQoJCQkJCXN0cmVhbUxvYWRlZDogZnVuY3Rpb24oZSwgZGF0YSkgew0KCQkJCQkJY29udGV4dC5sb2FkZXIuaGlkZSgpOw0KCQkJCQkJY29udGV4dC53cmFwcGVyLmZpbmQoJ2xpLmhpZ2hsaWdodCcpLnJlbW92ZUNsYXNzKCdoaWdobGlnaHQnKTsNCgkJCQkJfSwNCgkJCQkJc3RyZWFtTG9hZEVycm9yOiBmdW5jdGlvbihlLCBkYXRhKSB7DQoJCQkJCQljb250ZXh0LmxvYWRlci5oaWRlKCk7DQoJCQkJCQljb250ZXh0LndyYXBwZXIuZmluZCgnbGkuaGlnaGxpZ2h0JykucmVtb3ZlQ2xhc3MoJ2hpZ2hsaWdodCcpOw0KCQkJCQl9LA0KCQkJCQlhY3Rpdml0eUFwcGVuZGluZzogZnVuY3Rpb24oZSwgZGF0YSkgew0KCQkJCQkJZGF0YS5hY3Rpdml0eS5oaWRlKCk7DQoJCQkJCX0sDQoJCQkJCWFjdGl2aXR5QXBwZW5kZWQ6IGZ1bmN0aW9uKGUsIGRhdGEpIHsNCgkJCQkJCWlmKGRhdGEuYXV0bykgew0KCQkJCQkJCWRhdGEuYWN0aXZpdHkuYWRkQ2xhc3MoJ2hpZ2hsaWdodCcpLmZhZGVJbigzMDApOw0KCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQlkYXRhLmFjdGl2aXR5LnNob3coKTsNCgkJCQkJCX0NCgkJCQkJfSwNCgkJCQkJY29tbWVudEJlZ2luOiBmdW5jdGlvbihlLCBkYXRhKSB7DQoJCQkJCQlkYXRhLmFjdGl2aXR5DQoJCQkJCQkJLmZpbmQoJy5jb21tZW50LWZvcm0nKQ0KCQkJCQkJCS5zaG93KCkNCgkJCQkJCQkuZmluZCgndGV4dGFyZWEnKQ0KCQkJCQkJCS5mb2N1cygpOw0KCQkJCQl9LA0KCQkJCQljb21tZW50RWRpdDogZnVuY3Rpb24oZSwgZGF0YSkgew0KCQkJCQkJQWN0aXZpdHlTZXJ2aWNlLmxvY2soZGF0YS5hY3Rpdml0eS5maW5kKCcuY29tbWVudC1mb3JtIHRleHRhcmVhJykpOw0KCQkJCQkJZGF0YS5hY3Rpdml0eQ0KCQkJCQkJCS5maW5kKCcuY29tbWVudC1mb3JtJykNCgkJCQkJCQkuYWRkQ2xhc3MoJ3dpdGgtYXZhdGFyJyk7DQoJCQkJCX0sDQoJCQkJCWNvbW1lbnRDYW5jZWw6IGZ1bmN0aW9uKGUsIGRhdGEpIHsNCgkJCQkJCXZhciB0YSA9IGRhdGEuYWN0aXZpdHkuZmluZCgnLmNvbW1lbnQtZm9ybSB0ZXh0YXJlYScpOw0KCQkJCQkJaWYodGEudmFsKCkubGVuZ3RoID09PSAwKSB7DQoJCQkJCQkJQWN0aXZpdHlTZXJ2aWNlLnVubG9jayh0YSk7DQoJCQkJCQl9DQoJCQkJCQlkYXRhLmFjdGl2aXR5DQoJCQkJCQkJLmZpbmQoJy5jb21tZW50LWZvcm0nKQ0KCQkJCQkJCS5yZW1vdmVDbGFzcygnd2l0aC1hdmF0YXInKTsNCgkJCQkJfSwNCgkJCQkJY29tbWVudEFkZGluZzogZnVuY3Rpb24oZSwgZGF0YSkgew0KCQkJCQkJQWN0aXZpdHlTZXJ2aWNlLnVubG9jayhkYXRhLmFjdGl2aXR5RWxlbWVudC5maW5kKCcuY29tbWVudC1mb3JtIHRleHRhcmVhJykpOw0KCQkJCQkJZGF0YS5hY3Rpdml0eUVsZW1lbnQNCgkJCQkJCQkuZmluZCgnLmNvbW1lbnQtZm9ybSB0ZXh0YXJlYScpDQoJCQkJCQkJLmF0dHIoJ2Rpc2FibGVkJyx0cnVlKQ0KCQkJCQkJCS5ibHVyKCk7DQoJCQkJCX0sDQoJCQkJCWNvbW1lbnRBZGRlZDogZnVuY3Rpb24oZSwgZGF0YSkgew0KCQkJCQkJZGF0YS5hY3Rpdml0eUVsZW1lbnQNCgkJCQkJCQkuZmluZCgnLmNvbW1lbnQtZm9ybSB0ZXh0YXJlYScpDQoJCQkJCQkJLmV2b2x1dGlvbkNvbXBvc2VyKCd2YWwnLCcnKQ0KCQkJCQkJCS50cmlnZ2VyKCdrZXlkb3duJykgLy8gdG8gdHJpZ2dlciBhdXRvcmVzaXplIHRvIGNvbGxhcHNlDQoJCQkJCQkJLnRyaWdnZXIoJ2tleXVwJykgICAvLyB0byB0cmlnZ2VyIGF1dG9yZXNpemUgdG8gY29sbGFwc2UNCgkJCQkJCQkucmVtb3ZlQXR0cignZGlzYWJsZWQnKQ0KCQkJCQkJCS5jbG9zZXN0KCcuY29tbWVudC1mb3JtJykNCgkJCQkJCQkucmVtb3ZlQ2xhc3MoJ3dpdGgtYXZhdGFyJyk7DQoJCQkJCQlpZihkYXRhLmF1dG8pIHsNCgkJCQkJCQlkYXRhLmNvbW1lbnQuYWRkQ2xhc3MoJ2hpZ2hsaWdodCcpLmZhZGVJbigzMDApOw0KCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQlkYXRhLmNvbW1lbnQuc2hvdygpOw0KCQkJCQkJfQ0KCQkJCQl9LA0KCQkJCQljb21tZW50QWRkRXJyb3I6IGZ1bmN0aW9uKGUsIGRhdGEpIHsNCgkJCQkJCWRhdGEuYWN0aXZpdHlFbGVtZW50DQoJCQkJCQkJLmZpbmQoJy5jb21tZW50LWZvcm0gdGV4dGFyZWEnKQ0KCQkJCQkJCS5ldm9sdXRpb25Db21wb3NlcigndmFsJywnJykNCgkJCQkJCQkudHJpZ2dlcigna2V5ZG93bicpICAvLyB0byB0cmlnZ2VyIGF1dG9yZXNpemUgdG8gY29sbGFwc2UNCgkJCQkJCQkudHJpZ2dlcigna2V5dXAnKSAgIC8vIHRvIHRyaWdnZXIgYXV0b3Jlc2l6ZSB0byBjb2xsYXBzZQ0KCQkJCQkJCS5yZW1vdmVBdHRyKCdkaXNhYmxlZCcpDQoJCQkJCQkJLmNsb3Nlc3QoJy5jb21tZW50LWZvcm0nKQ0KCQkJCQkJCS5yZW1vdmVDbGFzcygnd2l0aC1hdmF0YXInKTsNCgkJCQkJfSwNCgkJCQkJY29tbWVudERlbGV0aW5nOiBmdW5jdGlvbihlLCBkYXRhKSB7IH0sDQoJCQkJCWNvbW1lbnREZWxldGVkOiBmdW5jdGlvbihlLCBkYXRhKSB7DQoJCQkJCQlkYXRhLmNvbW1lbnQucmVtb3ZlKCk7DQoJCQkJCX0sDQoJCQkJCWNvbW1lbnREZWxldGVFcnJvcjogZnVuY3Rpb24oZSwgZGF0YSkgew0KCQkJCQl9LA0KCQkJCQljb21tZW50c1Nob3dIaWRkZW46IGZ1bmN0aW9uKGUsIGRhdGEpIHsNCgkJCQkJCWRhdGEuYWN0aXZpdHlFbGVtZW50LmZpbmQoJ2xpLmNvbGxhcHNlJykuc2hvdygpLmVuZCgpLmZpbmQoJ2xpLmNvbGxhcHNlZC1jb21tZW50cycpLmhpZGUoKTsNCgkJCQkJfSwNCgkJCQkJY29tbWVudHNNb3JlTG9hZGVkOiBmdW5jdGlvbihlLCBkYXRhKSB7DQoJCQkJCQl2YXIgdmlld01vcmVJdGVtID0gZGF0YS5hY3Rpdml0eUVsZW1lbnQuZmluZCgnbGkuY29udGVudC1pdGVtLmFjdGlvbi5jb2xsYXBzZScpOw0KCQkJCQkJdmlld01vcmVJdGVtLnJlcGxhY2VXaXRoKGRhdGEuY29tbWVudHMpOw0KCQkJCQkJZGF0YS5hY3Rpdml0eUVsZW1lbnQuZmluZCgnbGkuY29udGVudC1pdGVtLmFjdGlvbi5jb2xsYXBzZScpLnNob3coKTsNCgkJCQkJfSwNCgkJCQkJY29tbWVudHNNb3JlRXJyb3I6IGZ1bmN0aW9uKGUsIGRhdGEpIHsNCgkJCQkJfSwNCgkJCQkJZmlsdGVyU2VsZWN0ZWQ6IGZ1bmN0aW9uKGUsIGRhdGEpIHsNCgkJCQkJCWRhdGEuZmlsdGVyRWxlbWVudC5jbG9zZXN0KCcuZmlsdGVycycpLmZpbmQoJy5maWx0ZXItb3B0aW9uJykucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7DQoJCQkJCQlkYXRhLmZpbHRlckVsZW1lbnQuY2xvc2VzdCgnLmZpbHRlci1vcHRpb24nKS5hZGRDbGFzcygnc2VsZWN0ZWQnKTsNCgkJCQkJfSwNCgkJCQkJbGlrZXNSZW1vdmVkOiBmdW5jdGlvbihlLCBkYXRhKSB7DQoJCQkJCQlkYXRhLmFjdGl2aXR5RWxlbWVudC5maW5kKCdsaS5saWtlcycpLnJlbW92ZUNsYXNzKCd3aXRoLWxpa2VzJykuYWRkQ2xhc3MoJ3dpdGhvdXQtbGlrZXMnKTsNCgkJCQkJfSwNCgkJCQkJbGlrZUFkZGVkOiBmdW5jdGlvbihlLCBkYXRhKSB7DQoJCQkJCQlkYXRhLmFjdGl2aXR5RWxlbWVudC5maW5kKCdsaS5saWtlcycpLnJlbW92ZUNsYXNzKCd3aXRob3V0LWxpa2VzJykuYWRkQ2xhc3MoJ3dpdGgtbGlrZXMnKTsNCgkJCQkJfQ0KCQkJCX0pOw0KCQkJfTsNCgkJcmV0dXJuIHsNCgkJCWluaXQ6IGZ1bmN0aW9uKGNvbnRleHQsIGNvbnRyb2xsZXIpIHsNCgkJCQljYXB0dXJlVWlFbGVtZW50cyhjb250ZXh0KTsNCgkJCQloYW5kbGVFdmVudHMoY29udGV4dCwgY29udHJvbGxlcik7DQoJCQl9DQoJCX07DQoJfSgpKTsNCg0KCXZhciBhcGkgPSB7DQoJCXJlZ2lzdGVyOiBmdW5jdGlvbihvcHRpb25zKSB7DQoJCQl2YXIgY29udGV4dCA9ICQuZXh0ZW5kKHsgZmlsdGVySW5kZXg6IDAsIGhhc01vcmVEYXRhOiB0cnVlIH0sIG9wdGlvbnMpOw0KCQkJQWN0aXZpdHlTZXJ2aWNlLmluaXQoY29udGV4dCk7DQoJCQlSZXBseVNlcnZpY2UuaW5pdChjb250ZXh0KTsNCgkJCVZpZXcuaW5pdChjb250ZXh0LCBDb250cm9sbGVyKTsNCgkJCUNvbnRyb2xsZXIuaW5pdChjb250ZXh0LCBBY3Rpdml0eVNlcnZpY2UsIFJlcGx5U2VydmljZSk7DQoJCX0NCgl9Ow0KDQoJaWYgKCEkLnRlbGxpZ2VudCkgeyAkLnRlbGxpZ2VudCA9IHt9OyB9DQoJaWYgKCEkLnRlbGxpZ2VudC5ldm9sdXRpb24pIHsgJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0ge307IH0NCglpZiAoISQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzKSB7ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0ge307IH0NCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5hY3Rpdml0eVN0b3J5U3RyZWFtID0gYXBpOw0KDQp9KShqUXVlcnksIHdpbmRvdyk7DQo=</file></files></scriptedContentFragment></scriptedContentFragments>